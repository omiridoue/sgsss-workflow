<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Building Your Own Computational Workflow for Social Scientists: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="../favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-warning">
          <abbr title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alpha
            </a>
            <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Building Your Own Computational Workflow for Social Scientists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Building Your Own Computational Workflow for Social Scientists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="learner_profiles.html">Learner Profiles</a></li>
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Groovy syntax</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Building Your Own Computational Workflow for Social Scientists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02.html">2. Hello Nextflow</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03.html">3. Parameters</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04.html">4. Channels</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05.html">5. Modules</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06.html">6. Modules Part 2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07.html">7. Workflow</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08.html">8. Operators</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09.html">9. Reporting</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10.html">10. Nextflow configuration</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="01.html">11. Auxiliary Tools</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="11.html">12. Resuming a Workflow</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="12.html">13. Portability of Workflow</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <li><a href="learner_profiles.html">Learner Profiles</a></li>
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Groovy syntax</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00"><p>Content from <a href="00.html">Introduction</a></p>
<hr>
<p>Last updated on 2025-06-28 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/00.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the FAIR research principles?</li>
<li>How do FAIR principles apply to software?</li>
<li>How does folder organisation help me?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the FAIR research principles in the context of research
software</li>
<li>Explain how file management helps in being FAIR</li>
<li>Understand elements of good naming strategy</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="fair-principles">FAIR principles<a class="anchor" aria-label="anchor" href="#fair-principles"></a>
</h3>
<p>FAIR stands for Findable, Accessible, Interoperable, and Reusable and
comprises a set of principles designed to increase the visibility and
usefulness of your research to others. FAIR principles have been applied
for software, here is a brief concept translation:</p>
<div class="section level4">
<h4 id="findable">Findable<a class="anchor" aria-label="anchor" href="#findable"></a>
</h4>
<ul>
<li>Create a description of your software to make it discoverable by
search engines and other search tools</li>
<li>Use a unique and persistent identifier (DOI) for your software
(e.g.¬†by depositing your code on Zenodo, OSF, GitHub)</li>
</ul>
</div>
<div class="section level4">
<h4 id="accessible">Accessible<a class="anchor" aria-label="anchor" href="#accessible"></a>
</h4>
<ul>
<li>The code and its description (metadata) has to be available even
when the software is no longer actively developed (this includes earlier
versions of the software)</li>
</ul>
</div>
<div class="section level4">
<h4 id="interoperable">Interoperable<a class="anchor" aria-label="anchor" href="#interoperable"></a>
</h4>
<ul>
<li>Use community-agreed standard formats for inputs and outputs of your
software and its metadata</li>
</ul>
</div>
<div class="section level4">
<h4 id="reusable">Reusable<a class="anchor" aria-label="anchor" href="#reusable"></a>
</h4>
<ul>
<li>Document your software (including its functionality, how to install
and run it) so it is both usable (can be executed) and reusable (can be
understood, modified, built upon, or incorporated into other
software)</li>
<li>Give a licence to your software clearly stating how it can be
reused</li>
</ul>
<div id="task-1.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-1.1" class="callout-inner">
<h3 class="callout-title">Task 1.1</h3>
<div class="callout-content">
<figure><img src="../fig/reproducible_replicable.svg" alt="Grid with the characteristics of: Reproducible; same data, same analysis. Replicable; different data, same analysis. Robust; same data, different analysis. And generalisable; different data, different analysis; Research" class="figure mx-auto d-block"><div class="figcaption">Grid with the characteristics of: Reproducible;
same data, same analysis. Replicable; different data, same analysis.
Robust; same data, different analysis. And generalisable; different
data, different analysis; Research</div>
</figure><p><em>The Turing Way</em> project illustration by Scriberia. Used under
a CC-BY 4.0 licence. DOI: <a href="https://doi.org/10.5281/zenodo.3332807" class="external-link">10.5281/zenodo.3332807</a>.</p>
<p>Join Menti: <a href="https://www.menti.com/alg8a76zkfgp" class="external-link uri">https://www.menti.com/alg8a76zkfgp</a></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Menti </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="padlet-embed" style="position: relative; padding-bottom: 56.25%; padding-top: 35px; height: 0; overflow: hidden;">
<p style="padding: 0; margin: 0;">
<iframe sandbox="allow-scripts allow-same-origin allow-presentation" allowfullscreen="true" allowtransparency="true" frameborder="0" height="315" src="https://www.mentimeter.com/app/presentation/alfn4xpqitna69dtr66ktgv1278zfrys/embed" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
</iframe>
</p>
</div>
</div>
</div>
</div>
</div>
<p><strong>File Naming</strong></p>
<p>There is no single way to manage file naming, but consistency is key.
Here‚Äôs a couple of options, and ways you can combine approaches:</p>
<table class="table">
<thead><tr class="header">
<th>Case Convention</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Pascal Case</td>
<td>PascalCase</td>
</tr>
<tr class="even">
<td>Camel Case</td>
<td>camelCase</td>
</tr>
<tr class="odd">
<td>Snake Case</td>
<td>snake_case</td>
</tr>
<tr class="even">
<td>Kebab Case</td>
<td>kebab-case</td>
</tr>
<tr class="odd">
<td>Flat Case</td>
<td>flatcase</td>
</tr>
<tr class="even">
<td>Upper Flat Case</td>
<td>UPPERFLATCASE</td>
</tr>
<tr class="odd">
<td>Pascal Snake Case</td>
<td>Pascal_Snake_Case</td>
</tr>
<tr class="even">
<td>Camel Snake Case</td>
<td>camel_Snake_Case</td>
</tr>
<tr class="odd">
<td>Screaming Snake Case</td>
<td>SCREAMING_SNAKE_CASE</td>
</tr>
</tbody>
</table>
<p>It‚Äôs good practice to mention your file naming convention in your
data management plan and/or meta data.</p>
<ol style="list-style-type: decimal">
<li>Choose a convention and apply it consistently</li>
<li>Use descriptive names</li>
<li>Optional: Tap into default ordering</li>
<li>Optional: Build file naming in your workflow</li>
</ol>
<div id="task-1.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-1.2" class="callout-inner">
<h3 class="callout-title">Task 1.2</h3>
<div class="callout-content">
<p>Before we dive into the details, let‚Äôs look at some examples of file
names, and come up with suggestions to improve clarity and
functionality.</p>
<table class="table">
<thead><tr class="header">
<th>üî® Needs work</th>
<th>‚úîÔ∏è Suggestion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>School123 Period1.RDS</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>period1_school123_A_ITER2_CONVERGED_SIM.RDS</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>school123_period1_I_goodness_fit.png</code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th>üî® Needs Edits</th>
<th>‚úîÔ∏è Suggestion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>School123 Period1.RDS</code></td>
<td><code>school123_period1.RDS</code></td>
</tr>
<tr class="even">
<td><code>period1_school123_A_ITER2_CONVERGED_SIM.RDS</code></td>
<td><code>school123_period1_A_ITER2_CONVERGED_SIM.RDS</code></td>
</tr>
<tr class="odd">
<td><code>school123_period1_I_goodness_fit.png</code></td>
<td><code>school123_period1_I_gof.png</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p><strong>Default ordering</strong></p>
<p>To create a default ordering, we can add a number or date at the
beginning of file names. This keeps our files sorted in ascending order
based on file versions or in chronological order. If your file name
starts with a number, we recommend left padding them with zeros, because
your computer will order <code>003 &lt; 004 &lt; 020 &lt; 100</code> as
opposed to <code>100 &lt; 20 &lt; 3 &lt; 4</code>. If you need to
re-order your files at a later point, you may be tempted to re-name all
of your files. It is best to use a template from the start to avoid
running into this mess.</p>
<p>There are certain conventions that apply to file naming, ex. if you
need to use a date then file names can start with
<code>year-month-day</code> (for example <code>2020-02-21</code>). We
recommend using something like the <a href="https://en.wikipedia.org/wiki/ISO_8601" class="external-link">ISO 8601 standard:
YYYY-MM-DD</a> for dates.</p>
<p><strong>Dynamically generated</strong></p>
<p>Output in multiple forms can be generated as part of running a
computational pipeline. Result files can contain a key identifier or
label, depending on your unit of analysis. Workflow managers offer
important scaffolding to support how you track the
<strong>flows</strong> of inputs and outputs across multiple stages of a
pipeline. The identifier may well be a pseudonym if your project works
with confidential data. We can come back to this to see how we can
assign handy <em>process labels</em> in our workflow with base functions
like <code>paste0()</code> in <em>R statistical software</em>. This way
we can concatenate literal words or values with ones that depend on the
input flowing into a process.</p>
<p><strong>Adapting a Workflow</strong></p>
<p>A repository (or a ‚Äúrepo‚Äù) is a storage location for your research
project. A repository can contain a range of digital objects and can be
used to store your project by using online platforms such as GitHub. The
aim of a repository is to organise your project in such a way that is
both accessible to others and efficient to use.</p>
<figure><img src="../fig/file-management.jpg" alt="File management system" class="figure mx-auto d-block"><div class="figcaption">File management system</div>
</figure><p>So far, we saw the key documents that one should add when starting or
setting up a project repository. If you are following along, navigate to
<a href="https://github.com/omiridoue/sgsss-workflow/tree/repo-boilerplate" class="external-link">repo-boilerplate</a>.</p>
<p><strong>Example for a Research Project</strong></p>
<p>A good way to map the organisation of folders within your directory
is using a file tree.</p>
<div id="task-1.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-1.3" class="callout-inner">
<h3 class="callout-title">Task 1.3</h3>
<div class="callout-content">
<p>Here are some suggestions on the files and folders your workflow
should have, you can download the template for the folder here:</p>
<pre><code>Project folder
‚îî‚îÄ‚îÄ üìÅworkflow                &lt;- Main workflow directory
  ‚îî‚îÄ‚îÄ üìÅapptainer          &lt;- Container definitions for Apptainer (formerly Singularity)
  ‚îî‚îÄ‚îÄ üìÅbin                 &lt;- Executable scripts used in the workflow, ex. in R these would be functions
  ‚îî‚îÄ‚îÄ üìÅconf               &lt;- Configuration files for different execution environments
  ‚îî‚îÄ‚îÄ üìÅdata               &lt;- Input data files for the workflow
  ‚îî‚îÄ‚îÄ üìÅdocker             &lt;- Docker container definition and dependencies
  ‚îî‚îÄ‚îÄ üìÅdocs               &lt;- Documentation, reports, and visualizations
  ‚îî‚îÄ‚îÄ üìÅmodules            &lt;- Nextflow modules for different analysis steps
  ‚îî‚îÄ‚îÄ üìÅparams             &lt;- Parameter files for the workflow
  ‚îî‚îÄ‚îÄ üìÅtemplates          &lt;- Template scripts used in the workflow
  ‚îî‚îÄ‚îÄ .dockerignore        &lt;- Files to exclude from Docker builds
  ‚îî‚îÄ‚îÄ .gitignore           &lt;- Files to exclude from Git version control
  ‚îî‚îÄ‚îÄ main.nf              &lt;- Main Nextflow workflow definition
  ‚îî‚îÄ‚îÄ nextflow.config      &lt;- Main Nextflow configuration
  ‚îî‚îÄ‚îÄ params.config        &lt;- Parameter configuration
  ‚îî‚îÄ‚îÄ README.md            &lt;- Project documentation</code></pre>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Step 1: Follow the link to <a href="https://github.com/omiridoue/sgsss-workflow/tree/repo-boilerplate" class="external-link">repo-boilerplate</a>
to navigate to the code repository.</p>
<p>Step 2: Click on the code tab to download the folders for the
workflow.</p>
<figure><img src="../fig/repo-boilerplate.png" alt="Workflow manager template folder build your own workflow" class="figure mx-auto d-block"><div class="figcaption">Workflow manager template folder build your own
workflow</div>
</figure><p>Alternatively, you can use git to download the code for the specific
branch, with the following code:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">-b</span> repo-boilerplate <span class="at">--single-branch</span> https://github.com/omiridoue/sgsss-workflow.git</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="example-repositories">Example repositories<a class="anchor" aria-label="anchor" href="#example-repositories"></a>
</h4>
<ul>
<li><a href="https://github.com/nextflow-io/nextflow" class="external-link">Nextflow
repository</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Name your files consistently</li>
<li>Keep it short but descriptive</li>
<li>Share/establish a naming convention when working with
collaborators</li>
<li>Consider generating output file names dynamically</li>
<li>Avoid special characters or spaces to keep it
machine-compatible</li>
<li>Use capitals or underscores to keep it human-readable</li>
<li>Use consistent date formatting, for example ISO 8601:
<code>YYYY-MM-DD</code> to maintain default order</li>
<li>Include a version number when applicable</li>
<li>Record a naming convention in your data management plan</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div></section><section id="aio-02"><p>Content from <a href="02.html">Hello Nextflow</a></p>
<hr>
<p>Last updated on 2025-07-12 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/02.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Nextflow?</li>
<li>Why should I use a workflow management system?</li>
<li>What are the features of Nextflow?</li>
<li>What are the main components of a Nextflow script?</li>
<li>How do I run a Nextflow script?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand a workflow management system.</li>
<li>Understand the benefits of using a workflow management system.</li>
<li>Explain the components of a Nextflow script.</li>
<li>Run a Nextflow script.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="workflows">Workflows<a class="anchor" aria-label="anchor" href="#workflows"></a>
</h3>
<p>Analysing data involves a sequence of tasks, including gathering,
cleaning, and processing data. This is what we refer to as data
wrangling. This is an important part of research and something that
should be documented. The sequence of tasks that picks up from the point
that the data is ready to work with is a workflow or a pipeline. These
workflows typically require using multiple software packages, sometimes
running on different computing environments, such as desktop or a
compute cluster. However, as workflows become larger and more complex,
the management of the programming logic and software becomes difficult.
<em>Workflow Management Systems</em> have been developed specifically to
manage computational data-analysis workflows.</p>
</div>
<div class="section level3">
<h3 id="workflow-management-systems">Workflow management systems<a class="anchor" aria-label="anchor" href="#workflow-management-systems"></a>
</h3>
<ul>
<li><p><strong>Reproducibility</strong>: Nextflow supports several
container technologies, such as <a href="https://www.docker.com/" class="external-link">Docker</a> and <a href="https://sylabs.io/singularity" class="external-link">Singularity</a>, as well as the
package manager <a href="https://docs.conda.io" class="external-link">Conda</a>. This, along
with the integration of the <a href="https://www.github.com" class="external-link">GitHub</a>
code sharing platform, allows you to write self-contained pipelines,
manage versions and to reproduce any previous result when re-run,
including on different computing platforms.</p></li>
<li><p><strong>Portability &amp; interoperability</strong>: Nextflow‚Äôs
syntax separates the functional logic (the steps of the workflow) from
the configuration (how the scripts run). This allows the pipeline to be
run on multiple platforms, e.g.¬†local compute vs.¬†a university compute
cluster or a cloud service like <a href="https://aws.amazon.com/" class="external-link">AWS</a>, without changing the steps of
the workflow.</p></li>
<li><p><strong>Simple parallelism</strong>: Nextflow is based on the
dataflow programming model which greatly simplifies the splitting of
tasks that can be run at the same time (parallelisation).</p></li>
<li><p><strong>Continuous checkpoints &amp; re-entrancy</strong>: All
the intermediate results produced during the pipeline execution are
automatically tracked. This allows you to resume its execution from the
last successfully implemented step, no matter what the reason was for it
stopping.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="processes-channels-and-workflows">Processes, channels, and workflows<a class="anchor" aria-label="anchor" href="#processes-channels-and-workflows"></a>
</h3>
<p>Nextflow workflows have three main parts: <em>processes</em>,
<em>channels</em>, and <em>workflows</em>.</p>
<ul>
<li><p><em>Processes</em> describe a task to be run. A process script
can be written in any scripting language that can be implemented by the
Linux platform (Bash, Perl, Ruby, Python, R, etc.). Processes spawn a
task for each complete input set. Each task is implemented independently
and cannot interact with other tasks. The only way data can be passed
between process tasks is via asynchronous queues, called
<em>channels</em>.</p></li>
<li><p>Processes define inputs and outputs for a task. <em>Channels</em>
are then used to manipulate the flow of data from one process to the
next.</p></li>
<li><p>The interaction between processes, and ultimately the pipeline
execution flow itself, is then explicitly defined in a <em>workflow</em>
section.</p></li>
</ul>
<p>Independent instances (tasks) of a process are run in parallel. Each
task generates an output, which is passed to another channel and used as
input for the next process. We‚Äôll figure out how this works with some of
the practice examples in the following sections.</p>
</div>
<div class="section level3">
<h3 id="workflow-implementation">Workflow implementation<a class="anchor" aria-label="anchor" href="#workflow-implementation"></a>
</h3>
<p>While a <code>process</code> defines what command or script has to be
implemented, the <code>runtime profile</code> determines how that script
is actually run in the target system. If not otherwise specified,
processes are implemented on the local computer. The local runtime
profile is very useful for pipeline development, testing, and
small-scale workflows, but for large-scale computational pipelines, a
High Performance Cluster (HPC) or Cloud platform is often required.</p>
<p align="center">
<img src="../fig/executor.png" alt="Diagram of a computational process within a bioinformatics workflow. The image features a large, central, rounded rectangle labeled 'process' with a smaller rectangle inside it labeled 'script', indicating the code or commands that are being implemented. Above the script box, there is a smaller inset labeled 'Executors' with three icons: a desktop computer labeled 'Local', a stack of servers labeled 'High Performance Compute Cluster', and a cloud symbol labeled 'Cloud Compute'. These represent the different computing environments where the script can be implemented. To the left of the process box is a green left-pointing arrowhead, suggesting input into the process, and to the right is a yellow right-pointing arrowhead, indicating the direction of output from the process." width="350" class="figure"><br><em>Runtime</em>
</p>
<p>Nextflow provides a separation between the pipeline‚Äôs functional
logic and the underlying execution platform. This makes it possible to
write a pipeline once, and then run it on your computer, compute
cluster, or the cloud, without modifying the workflow, by defining the
target platform in a configuration file. Note multiple configurations
can be defined, and the choice is left to the user, a full list can be
found <a href="https://www.nextflow.io/docs/latest/executor.html" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="your-first-script">Your first script<a class="anchor" aria-label="anchor" href="#your-first-script"></a>
</h3>
<p>We are now going to look at a sample Nextflow script that extracts a
folder with data files. First step involves navigating to the relevant
script, <code>02_hello_nextflow.nf</code> in the current directory. The
instructions to set up the code material can be found under <a href="https://omiridoue.github.io/sgsss-workflow/index.html" class="external-link">setup</a>.</p>
<div id="task-2.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-2.1" class="callout-inner">
<h3 class="callout-title">Task 2.1</h3>
<div class="callout-content">
<p>The nextflow scripts for each lesson episode are available in the
<code>scripts</code> directory created during the course setup. Open the
<code>02_hello_nextflow.nf</code> script and consider each section of
the script.</p>
<p>Hint: Check that your terminal displays the following file path:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">training/sgsss-workflow/scripts</span> <span class="at">-</span><span class="op">&gt;</span> </span></code></pre>
</div>
<p>Use the <code>cd</code> command to change directory followed by the
folder name or relative path you want to navigate to, ex.
<code>cd sgsss-workflow</code>. If you want to go back up a level or
folder in your directory, you can type <code>cd ..</code></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>This is a Nextflow script, which contains the following:</p>
<ol style="list-style-type: decimal">
<li>An optional interpreter directive (‚ÄúShebang‚Äù) line, specifying the
location of the Nextflow interpreter.</li>
<li>A multi-line Nextflow comment, written using C style block comments,
there are more comments later in the file.</li>
<li>A pipeline parameter <code>params.input</code> which is given a
default value, of the relative path to the location of a compressed
archive of data, as a string.</li>
<li>A Nextflow channel <code>input_ch</code> used to read in data to the
workflow.</li>
<li>An unnamed <code>workflow</code> execution block, which is the
default workflow to run.</li>
<li>A call to the process <code>GENERATE_READS</code>.</li>
<li>An operation on the process output, using the channel operator
<code>.view()</code>.</li>
<li>A Nextflow process block named <code>GENERATE_READS</code>, which
defines what the process does.</li>
<li>An <code>input</code> definition block that assigns the
<code>input</code> to the variable <code>read</code>, and declares that
it should be interpreted as a file path.</li>
<li>An <code>output</code> definition block that uses the Linux/Unix
standard output stream with file path from the script block.</li>
<li>A script block that contains the bash commands
<code>printf '${targz}\\t'</code> and <code>tar -xzf $targz</code>.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="running-nextflow-scripts">Running Nextflow scripts<a class="anchor" aria-label="anchor" href="#running-nextflow-scripts"></a>
</h3>
<p>To run a Nextflow script use the command
<code>nextflow run &lt;script_name&gt;</code>.</p>
<div id="task-2.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-2.2" class="callout-inner">
<h3 class="callout-title">Task 2.2</h3>
<div class="callout-content">
<p>Run the script by entering the following command in your
terminal:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">nextflow</span> run 02_hello_nextflow.nf</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Output </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>You should see output similar to the text shown below:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> N E X T F L O W   ~  version 24.10.4

Launching `02_hello_nextflow.nf` [frozen_booth] DSL2 - revision: 8a3d1bb9c7

executor &gt;  local (1)
[52/af3b5c] GENERATE_READS (1) [100%] 1 of 1 ‚úî
[/workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school123_period1.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school123_period2.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school124_period1.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school124_period2.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school125_period1.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school125_period2.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school126_period1.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school126_period2.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school127_period1.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school127_period2.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school128_period1.RDS, /workspaces/training/work/52/af3b5ca0b401d80915bf823d321a7f/school128_period2.RDS]</code></pre>
</div>
<ol style="list-style-type: decimal">
<li>The first line shows the Nextflow version number.</li>
<li>The second line shows the run name <code>frozen_booth</code>
(adjective and scientist name) and revision id
<code>8a3d1bb9c7</code>.</li>
<li>The third line tells you the process has been implemented locally
(<code>executor &gt;  local</code>).</li>
<li>The next line shows the process id <code>52/af3b5c</code>, process
name, number of cpus, percentage task completion, and how many instances
of the process have been run. Each instance is listed sequentially and
separated by a <code>,</code> to demonstrate the flow of data as
inputs.</li>
<li>The final line is the output of the <code>.view()</code>
operator.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="quick-recap">Quick recap<a class="anchor" aria-label="anchor" href="#quick-recap"></a>
</h3>
<ul>
<li>A workflow is a sequence of tasks that process a set of data, and a
workflow management system (WfMS) is a computational platform that
provides an infrastructure for the set-up, execution and monitoring of
workflows.</li>
<li>Nextflow scripts comprise of <em>channels</em> for controlling
inputs and outputs, and <em>processes</em> for defining workflow
tasks.</li>
<li>You run a Nextflow script using the <code>nextflow run</code>
command.</li>
</ul>
</div>
<div class="section level3">
<h3 id="specifying-an-output-directory-in-the-script">Specifying an output directory in the script<a class="anchor" aria-label="anchor" href="#specifying-an-output-directory-in-the-script"></a>
</h3>
<p>To specify an output directory for a script use the parameter
<code>publishDir</code> in the definition of a process.</p>
<div id="task-2.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-2.3" class="callout-inner">
<h3 class="callout-title">Task 2.3</h3>
<div class="callout-content">
<p>Let‚Äôs edit the <code>02_hello_nextflow.nf</code> script and specify
the output directory, where we want Nextflow to store data files that
were the result of decompressing the <code>tar</code> archive
folder.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The files that are extracted from the archive are stored in the
folder <code>work</code> that tracks the different tasks that are
launched as part of the pipeline. If we want a local copy of files that
are decompressed we can add an output directory with the following
code:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  publishDir <span class="st">"</span><span class="ss">$projectDir</span><span class="st">"</span><span class="op">,</span> mode<span class="op">:</span> <span class="st">"copy"</span><span class="op">,</span> overwrite<span class="op">:</span> <span class="kw">true</span></span></code></pre>
</div>
<p><strong>Note:</strong> You should always add a sensible default value
to the pipeline parameter.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">// 02_hello_nextflow.nf</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>process GENERATE_READS <span class="op">{</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>          path targz</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  publishDir <span class="st">"</span><span class="ss">$projectDir</span><span class="st">"</span><span class="op">,</span> mode<span class="op">:</span> <span class="st">"copy"</span><span class="op">,</span> overwrite<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>          path <span class="st">"*"</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>          <span class="st">"""</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="st">          tar -xzf </span><span class="ss">$targz</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="st">          # Print file name</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="st">          printf '</span><span class="ss">${</span>targz<span class="ss">}</span><span class="sc">\\</span><span class="st">t'</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="st">          """</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
<p>Here we‚Äôve added the output directory <code>"$projectDir"</code> in
the process <code>GENERATE_READS</code>.</p>
<p>This step, <code>publishDir "$projectDir"</code>, will add a
directory to output the decompressed files. The set of options that can
be specified are listed in the <a href="https://www.nextflow.io/docs/latest/reference/stdlib.html" class="external-link">Nextflow
documentation</a>. To access the value inside the process definition we
use <code>$parameter</code> syntax e.g.¬†<code>$projectDir</code>.</p>
<p>You can also try to tweak the parameter, and specify a sub-folder
called <code>tmp</code> that will store the output of the process
<code>"$projectDir/tmp"</code>.</p>
<p>The new line of code should read:</p>
<p><code>publishDir "$projectDir/tmp", mode: "copy", overwrite: true</code></p>
<p>How would this change where the output is stored?</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A workflow is a sequence of tasks that process a set of data.</li>
<li>A workflow management system (WfMS) is a computational platform that
provides an infrastructure for the set-up, execution and monitoring of
workflows.</li>
<li>Nextflow scripts comprise of channels for controlling inputs and
outputs, and processes for defining workflow tasks.</li>
<li>You run a Nextflow script using the <code>nextflow run</code>
command.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div></section><section id="aio-03"><p>Content from <a href="03.html">Parameters</a></p>
<hr>
<p>Last updated on 2025-06-28 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/03.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I change the data a workflow uses?</li>
<li>How can I parameterise a workflow?</li>
<li>How can I add my parameters to a file?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use pipeline parameters to change the input to a workflow.</li>
<li>Add pipeline parameters to a Nextflow script.</li>
<li>Understand how to create and use a parameter file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In the first episode we ran the Nextflow script,
<code>02_hello_nextflow.nf</code>, from the command line and it
de-compressed the archive folder <code>each_period.tar.gz</code> that
contained synthetic data on 4 individual schools for two time points. To
change the input to script we can make use of pipeline parameters.</p>
<section><h2 class="section-heading" id="pipeline-parameters">Pipeline parameters<a class="anchor" aria-label="anchor" href="#pipeline-parameters"></a>
</h2>
<hr class="half-width">
<p>The Nextflow <code>02_hello_nextflow.nf</code> script defines a
pipeline parameter <code>params.input</code>. Pipeline parameters enable
you to change the input to the workflow at runtime, via the command line
or a configuration file, so they are not hard-coded into the script.</p>
<p>Pipeline parameters are declared in the workflow by prepending the
prefix <code>params</code>, separated by the dot character, to a
variable name e.g., <code>params.input</code>.</p>
<p>Their value can be specified on the command line by prefixing the
parameter name with a <strong>double dash</strong> character, e.g.,
<code>--input</code>.</p>
<p>In the script <code>02_hello_nextflow.nf</code> the pipeline
parameter <code>params.input</code> was specified with the file path
<code>"data/each_period.tar.gz"</code>.</p>
<div id="task-3.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-3.1" class="callout-inner">
<h3 class="callout-title">Task 3.1</h3>
<div class="callout-content">
<p>The input for data can be passed with the
<code>--variable_name</code> convention. In this case we used a named
input for our parameter. Note variables can also be specified through
the command line using two dashes. Any other options would normally be
specified using a single dash, this includes the <code>-resume</code>
tag which is important for code development, we can come back to it in a
later section.</p>
<p>To process a different file,
e.g.¬†<code>data/multi_period.tar.gz</code>, in the
<code>02_hello_nextflow.nf</code> script we would run:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">nextflow</span> run 02_hello_nextflow.nf <span class="at">--input</span> <span class="st">'data/multi_period.tar.gz'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> N E X T F L O W   ~  version 24.10.4

Launching `02_hello_nextflow.nf` [loving_brenner] DSL2 - revision: 8a3d1bb9c7

executor &gt;  local (1)
executor &gt;  local (1)
[49/214249] process &gt; GENERATE_READS (1) [100%] 1 of 1 ‚úî
[/workspaces/training/sgsss-workflow/scripts/work/49/21424945038a3a509a67cf9d092711/school123.RDS,
/workspaces/training/sgsss-workflow/scripts/work/49/21424945038a3a509a67cf9d092711/school124.RDS,
/workspaces/training/sgsss-workflow/scripts/work/49/21424945038a3a509a67cf9d092711/school125.RDS,
/workspaces/training/sgsss-workflow/scripts/work/49/21424945038a3a509a67cf9d092711/school126.RDS]</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can also use wild cards to specify multiple input files (This will
be covered in the channels episode). In the example below we use the
<code>*</code> to match any sequence of characters before
<code>data/multi_period.tar.gz</code>. <strong>Note:</strong> If you use
wild card characters on the command line you must enclose the value in
quotes.</p>
<div id="task-3.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-3.2" class="callout-inner">
<h3 class="callout-title">Task 3.2</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">nextflow</span> run 02_hello_nextflow.nf <span class="at">--input</span> <span class="st">'data/*multi_period.tar.gz'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>This runs the process GENERATE_DAT twice, once for each file it
matches.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> N E X T F L O W   ~  version 24.10.4

Launching `02_hello_nextflow.nf` [grave_hopper] DSL2 - revision: 8a3d1bb9c7

executor &gt;  local (2)
[5f/7df89f] process &gt; GENERATE_READS (2) [100%] 2 of 2 ‚úî
[/workspaces/training/sgsss-workflow/scripts/work/df/253fc08b9b2941144e0e67c8e3c213/school123.dat,
/workspaces/training/sgsss-workflow/scripts/work/df/253fc08b9b2941144e0e67c8e3c213/school124.dat,
/workspaces/training/sgsss-workflow/scripts/work/df/253fc08b9b2941144e0e67c8e3c213/school125.dat,
/workspaces/training/sgsss-workflow/scripts/work/df/253fc08b9b2941144e0e67c8e3c213/school126.dat]

[/workspaces/training/sgsss-workflow/scripts/work/5f/7df89f35cb0de22fe9eb6c91e833ed/school123.RDS,
/workspaces/training/sgsss-workflow/scripts/work/5f/7df89f35cb0de22fe9eb6c91e833ed/school124.RDS,
/workspaces/training/sgsss-workflow/scripts/work/5f/7df89f35cb0de22fe9eb6c91e833ed/school125.RDS,
/workspaces/training/sgsss-workflow/scripts/work/5f/7df89f35cb0de22fe9eb6c91e833ed/school126.RDS]
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="task-3.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-3.3" class="callout-inner">
<h3 class="callout-title">Task 3.3</h3>
<div class="callout-content">
<p>Re-run the Nextflow script <code>02_hello_nextflow.nf</code> by
changing the pipeline input to all files in the directory that end with
<code>each_period.tar.gz</code>:</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">nextflow</span> run 02_hello_nextflow.nf <span class="at">--input</span> <span class="st">'data/*each_period.tar.gz'</span></span></code></pre>
</div>
<p>The string specified on the command line will override the default
value of the parameter in the script. The output will look like
this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
 N E X T F L O W   ~  version 24.10.4

Launching `02_hello_nextflow.nf` [lethal_cajal] DSL2 - revision: 8a3d1bb9c7

executor &gt;  local (2)
[05/8e0aa0] process &gt; GENERATE_READS (1) [100%] 2 of 2 ‚úî
[/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school123_period1.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school123_period2.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school124_period1.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school124_period2.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school125_period1.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school125_period2.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school126_period1.dat,
/workspaces/training/sgsss-workflow/scripts/work/05/8e0aa09cc3795d1a3fc2ed1384adf7/school126_period2.dat]

executor &gt;  local (2)
[05/8e0aa0] process &gt; GENERATE_READS (1) [100%] 2 of 2 ‚úî

[/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school123_period1.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school123_period2.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school124_period1.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school124_period2.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school125_period1.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school125_period2.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school126_period1.RDS,
/workspaces/training/sgsss-workflow/scripts/work/07/303a7d7f5a8a582db4d9df86d68a08/school126_period2.RDS]
</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="parameter-file">Parameter File<a class="anchor" aria-label="anchor" href="#parameter-file"></a>
</h2>
<hr class="half-width">
<p>If we have many parameters to pass to a script it is best to create a
parameters file. The convention is for the file to be placed on the top
level of our workflow folder and for this to be named
<code>params.config</code>.</p>
<div id="task-3.4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-3.4" class="callout-inner">
<h3 class="callout-title">Task 3.4</h3>
<div class="callout-content">
<p>We have created a parameter file <code>params.config</code> for the
workflow. Based on the intended parameter definition, what implicit
Nextflow variables could we use as part of the defintion? Notice we want
to rename our params.input to params.school_data to make our script more
specific and clear.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
batches                     : 1
model specification         : /workspaces/training/sgsss-workflow/scripts/params/meta.csv
school data                 : /workspaces/training/sgsss-workflow/scripts/data/each_period.tar.gz
school info                 : /workspaces/training/sgsss-workflow/scripts/params/school_info.json
composition data            : /workspaces/training/sgsss-workflow/scripts/data/composition_each_period.tar.gz
effects                     : /workspaces/training/sgsss-workflow/scripts/params/effects.csv
subgroup                    : /workspaces/training/sgsss-workflow/scripts/params/subgroup.csv
</code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Parameters </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Here we use the nextflow environment variable <code>baseDir</code>
which is resolved by the workflow at runtime. The path to the data and
params folder is specified through use of relative file paths. Open the
<code>params.config</code> file to inspect the following:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">// params.config</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>params <span class="op">{</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                outdir <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/results"</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                batches <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                meta <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/meta.csv"</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                effects <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/effects.csv"</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                subgroup <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/subgroup.csv"</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                school_data <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/data/each_period.tar.gz"</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>                school_info <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/school_info.json"</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>                composition_data <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/data/composition_each_period.tar.gz"</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
<p>To point Nextflow to this <code>params.config</code> file, we include
the following code <code>includeConfig "params.config"</code>, in our
workflow configuration file.<code>nextflow.config</code>.</p>
<p>Open the <code>03_params.nf</code> and check the syntax, notice we
abstract the parameterisation of the workflow from the workflow
definition. This means we no longer need to define a parameter in our
main workflow file, so long as we point nextflow to the
<code>params.config</code> file.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>nextflow run <span class="er">03</span>_params<span class="op">.</span>nf </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Pipeline parameters are specified by prepending the prefix
<code>params</code> to a variable name, separated by a dot
character.</li>
<li>To specify a pipeline parameter on the command line for a Nextflow
run use <code>--variable_name</code> syntax.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-04"><p>Content from <a href="04.html">Channels</a></p>
<hr>
<p>Last updated on 2025-07-05 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/04.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I move data around in Nextflow?</li>
<li>How do I handle different types of input, e.g.¬†files and
parameters?</li>
<li>How can I use pattern matching to select input files?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how Nextflow manages data using channels.</li>
<li>Create a value and queue channel using channel factory methods.</li>
<li>Edit channel factory arguments to alter how data is read in.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="channels">Channels<a class="anchor" aria-label="anchor" href="#channels"></a>
</h2>
<hr class="half-width">
<p>Earlier we saw that channels are the way in which Nextflow sends data
around a workflow. Channels connect processes via their inputs and
outputs. Channels can store multiple items, such as values. The number
of items a channel stores, determines how many times a process will run,
using that channel as input.<br><em>Note:</em> When the process runs using one item from the input
channel, we will call that run a <code>task</code>. Each task is run in
its own self-enclosed environment.</p>
</section><section><h2 class="section-heading" id="why-use-channels">Why use Channels?<a class="anchor" aria-label="anchor" href="#why-use-channels"></a>
</h2>
<hr class="half-width">
<p>Channels are how Nextflow handles file management, allowing complex
tasks to be split up, and run in parallel.</p>
<figure><img src="../fig/channel-files.png" alt="Channel files" class="figure mx-auto d-block"></figure><p>Channels are asynchronous, which means that outputs from a set of
processes will not necessarily be produced in the same order as the
corresponding inputs went in. However, the first element into a channel
queue is the first out of the queue (First in - First out). This allows
processes to run as soon as they receive input from a channel. Channels
only send data in one direction.</p>
</section><section><h2 class="section-heading" id="channel-types">Channel types<a class="anchor" aria-label="anchor" href="#channel-types"></a>
</h2>
<hr class="half-width">
<p>Nextflow distinguishes between two different kinds of channels:
<strong>queue</strong> channels and <strong>value</strong> channels.</p>
<p><strong>Queue channel</strong></p>
<p>Queue channels are a type of channel in which data is consumed (used
up) to make input for a process/operator. Queue channels can be created
in two ways:</p>
<ol style="list-style-type: decimal">
<li>As the outputs of a process.</li>
<li>Channel factory methods <a href="https://www.nextflow.io/docs/latest/channel.html#of" class="external-link">Channel.of</a>
or <a href="https://www.nextflow.io/docs/latest/channel.html#frompath" class="external-link">Channel.fromPath</a>.</li>
</ol>
<p><strong>Value channels</strong></p>
<p>The second type of Nextflow channel is a <code>value</code> channel.
A <strong>value</strong> channel is bound to a <strong>single</strong>
value. A value channel can be used an unlimited number times since its
content is not consumed.</p>
<div id="task-4.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-4.1" class="callout-inner">
<h3 class="callout-title">Task 4.1</h3>
<div class="callout-content">
<p>What type of channel would you use to store the following?</p>
<ol style="list-style-type: decimal">
<li>Multiple values.</li>
<li>A list with one or more values.</li>
<li>A single value.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>A queue channels is used to store multiple values.</li>
<li>A value channel is used to store a single value, this can be a list
with multiple values.</li>
<li>A value channel is used to store a single value.</li>
</ol>
</div>
</div>
</div>
</div>
<p>Navigate to the nextflow file to the 04_channels.nf file (Hint:
Ensure your working directory is, training/sgsss-workflow/scripts/).
Again this file path will likely look different if you have set up on
your local computer.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Navigate to the nextflow script called to <code>04_channels.nf</code>
for the following examples. Explain that as you are just setting up
channels you do not need to add any processes or a workflow block.</p>
<p>Run the channels example file using:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> nextflow run 04_channels.nf</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="creating-channels-using-channel-factories">Creating Channels using Channel factories<a class="anchor" aria-label="anchor" href="#creating-channels-using-channel-factories"></a>
</h2>
<hr class="half-width">
<p>Channel factories are used to explicitly create channels. In
programming, factory methods (functions) are a programming design
pattern used to create different types of objects (in this case,
different types of channels). They are implemented for things that
represent more generalised concepts, such as a <code>Channel</code>.</p>
<p>Channel factories are called using the
<code>Channel.&lt;method&gt;</code> syntax, and return a specific
instance of a <code>Channel</code>.</p>
<p><strong>The value Channel factory</strong></p>
<p>The <code>value</code> factory method is used to create a value
channel. Values are put inside parentheses <code>()</code> to assign
them to a channel.</p>
<ol style="list-style-type: decimal">
<li>Creates a value channel and binds a string to it.</li>
<li>Creates a value channel and binds a list object to it that will be
emitted as a single item.</li>
<li>Creates a value channel and binds a map object to it that will be
emitted as a single item.</li>
</ol>
<p>The value method can only take 1 argument, however, this can be a
single list or map containing several elements.</p>
<p><em>Reminder:</em></p>
<ul>
<li>A <a href="https://www.tutorialspoint.com/groovy/groovy_lists.htm" class="external-link">List
object</a> can be defined by placing the values in square brackets
<code>[]</code> separated by a comma.</li>
<li>A <a href="https://www.tutorialspoint.com/groovy/groovy_maps.htm" class="external-link">Map
object</a> is similar, but with <code>key:value pairs</code> separated
by commas.</li>
</ul>
<p>To view the contents of a value channel, use the <code>view</code>
operator. We will learn more about channel operators in a later
section.</p>
<p><strong>Queue channel factory</strong></p>
<p>Queue (consumable) channels can be created using the following
channel factory methods.</p>
<ul>
<li><code>Channel.of</code></li>
<li><code>Channel.fromList</code></li>
<li><code>Channel.fromPath</code></li>
<li><code>Channel.fromFilePairs</code></li>
</ul>
<p><strong>The <strong>of</strong> Channel factory</strong></p>
<p>When you want to create a channel containing multiple values you can
use the channel factory <code>Channel.of</code>. This allows the
creation of a <code>queue</code> channel with the values specified as
arguments, separated by a <code>,</code>.</p>
<p>Arguments passed to the <code>of</code> method can be of varying
types e.g., combinations of numbers, strings, or objects. In the above
examples we have examples of both string and number data types.</p>
<div id="channel.from" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="channel.from" class="callout-inner">
<h3 class="callout-title">Channel.from</h3>
<div class="callout-content">
<p>You may see the method <code>Channel.from</code> in older nextflow
scripts. This performs a similar function but is now deprecated (no
longer used), and so <code>Channel.of</code> should be used instead.</p>
<div class="section level4">
<h4 id="the-fromlist-channel-factory">The <strong>fromList</strong> Channel factory<a class="anchor" aria-label="anchor" href="#the-fromlist-channel-factory"></a>
</h4>
<p>You can use the <code>Channel.fromList</code> method to create a
queue channel from a list object.</p>
</div>
</div>
</div>
</div>
<div id="task-4.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-4.2" class="callout-inner">
<h3 class="callout-title">Task 4.2</h3>
<div class="callout-content">
<p>Write a Nextflow script that creates a <code>value</code> channel
using <code>meta_verbose_ch</code> as input, containing the list of
values <code>["all","influence","selection", "none"]</code>. These
represent the different specifications of our models. Essentially we‚Äôd
like to conduct a set of model comparison checks by estimating a full
specification and nested sub-models. Open up the <a href="https://www.nextflow.io/docs/latest/channel.html" class="external-link">nextflow
docs</a> to check the syntax for this.</p>
<p>Then print the contents of the channels using the <code>view</code>
operator. How many lines does the queue and value channel print?</p>
<p><strong>Hint:</strong> Use the <code>fromList()</code>, and
<code>value()</code> Channel factory methods. You can also use
<code>of()</code> and try to compare it to <code>fromList()</code>, what
differences do you notice?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Notice we‚Äôve added the following code to <code>04_channels.nf</code>,
building on the previous workflow definition:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="dt">def</span> meta_verbose_ch <span class="op">=</span> <span class="op">[</span><span class="st">"all"</span><span class="op">,</span><span class="st">"influence"</span><span class="op">,</span><span class="st">"selection"</span><span class="op">,</span> <span class="st">"none"</span><span class="op">]</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    composition <span class="op">=</span> <span class="fu">GENERATE_READS</span><span class="op">(</span>ZipChannel_dat<span class="op">)</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="op">|</span> flatten \</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="op">|</span> map <span class="op">{</span> file <span class="op">-&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="dt">def</span> key <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">'</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="dt">def</span> school_ID <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"_|</span><span class="sc">\\</span><span class="st">."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">tuple</span><span class="op">(</span>school_ID<span class="op">,</span> key<span class="op">,</span> file<span class="op">)}</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    composition \</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="op">|</span> view</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    <span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span>meta_verbose_ch<span class="op">)</span> \</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    <span class="op">|</span> view</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromList</span><span class="op">(</span>meta_verbose_ch<span class="op">)</span> \</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    <span class="op">|</span> view</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="channel.fromlist-vs-channel.of" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="channel.fromlist-vs-channel.of" class="callout-inner">
<h3 class="callout-title">Channel.fromList vs Channel.of</h3>
<div class="callout-content">
<p>In the above example, the channel has four elements. If you used the
Channel.of(meta_verbose_ch) it would have contained only 1 element
<code>[all, influence, selection, none]</code> and any operator or
process using the channel would run <strong>once</strong>.</p>
</div>
</div>
</div>
<p><strong>The <strong>fromPath</strong> Channel factory</strong></p>
<p>The previous channel factory methods dealt with sending general
values in a channel. A special channel factory method
<code>fromPath</code> is used when wanting to pass files.</p>
<p>The <code>fromPath</code> factory method creates a <strong>queue
channel</strong> containing one or more files matching a file path.</p>
<p>The file path (written as a quoted string) can be the location of a
single file or a ‚Äúglob pattern‚Äù that matches multiple files or
directories.</p>
<p>The file path can be a relative path (path to the file from the
current directory), or an absolute path (path to the file from the
system root directory - starts with <code>/</code>).</p>
<p>Use the glob syntax to specify pattern-matching behaviour for files.
A glob pattern is specified as a string and is matched against directory
or file names.</p>
<ul>
<li>An asterisk, <code>*</code>, matches any number of characters
(including none).</li>
<li>Two asterisks, <code>**</code>, works like * but will also search
sub directories. This syntax is generally used for matching complete
paths.</li>
<li>Braces <code>{}</code> specify a collection of subpatterns. For
example: <code>{period1,period2}</code> matches ‚Äúperiod1‚Äù or
‚Äúperiod2‚Äù</li>
</ul>
<p>For example the script below uses the <code>*.tar.gz</code> pattern
to create a queue channel that contains as many items as there are files
with <code>.tar.gz</code> extension in the <code>data/</code>
folder.</p>
<p><strong>Note</strong> The pattern must contain at least a star
wildcard character.</p>
<p>You can change the behaviour of <code>Channel.fromPath</code> method
by changing its options. A list of <code>.fromPath</code> options is
shown below.</p>
<p>Available fromPath options:</p>
<table class="table">
<colgroup>
<col width="9%">
<col width="90%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>glob</td>
<td>When true, the characters <code>*</code>, <code>?</code>,
<code>[]</code> and <code>{}</code> are interpreted as glob wildcards,
otherwise they are treated as literal characters (default: true)</td>
</tr>
<tr class="even">
<td>type</td>
<td>The type of file paths matched by the string, either
<code>file</code>, <code>dir</code> or <code>any</code> (default:
file)</td>
</tr>
<tr class="odd">
<td>hidden</td>
<td>When true, hidden files are included in the resulting paths
(default: false)</td>
</tr>
<tr class="even">
<td>maxDepth</td>
<td>Maximum number of directory levels to visit (default: no limit)</td>
</tr>
<tr class="odd">
<td>followLinks</td>
<td>When true, symbolic links are followed during directory tree
traversal, otherwise they are managed as files (default: true)</td>
</tr>
<tr class="even">
<td>relative</td>
<td>When true returned paths are relative to the top-most common
directory (default: false)</td>
</tr>
<tr class="odd">
<td>checkIfExists</td>
<td>When true throws an exception if the specified path does not exist
in the file system (default: false)</td>
</tr>
</tbody>
</table>
<p>We can change the default options for the <code>fromPath</code>
method to give an error if the file doesn‚Äôt exist using the
<code>checkIfExists</code> parameter. In Nextflow, method parameters are
separated by a <code>,</code> and parameter values specified with a
colon <code>:</code>.</p>
<p>If we execute a Nextflow script with the contents below, it will run
and not produce an output, or an error message that the file does not
exist. This is likely not what we want.</p>
<p>Add the argument <code>checkIfExists</code> with the value
<code>true</code>.</p>
<p>This will give an error as there is no data directory.</p>
<div id="task-4.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-4.3" class="callout-inner">
<h3 class="callout-title">Task 4.3</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Navigate to the Nextflow script file called
<code>04_channels.nf</code> .</li>
<li>The pre-populated code involves x5 queue channels. Identify the name
of each of these channels. Write comments within your script to explain
what this queue channel involves.</li>
<li>Hint: Run the workflow script through the terminal with
<code>nextflow run</code>.</li>
<li>Hint: use the <code>.view()</code> operator to print the output of
the channel. Again type the <code>nextflow run</code> command to run the
workflow.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>#<span class="op">!</span><span class="st">/usr/</span>bin<span class="op">/</span>env nextflow</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">//04_channels.nf</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">===========================================================</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"> pipeline for independent models runs for each schools</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"> for each time period, implemented in Siena</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"> we can then perform a meta-analysis on the results</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"> @authors</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"> Eleni Omiridou &lt;2333157O@student.gla.ac.uk&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">===========================================================</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">* Default pipeline parameters</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>params<span class="op">.</span>help            <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>params<span class="op">.</span>resume          <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>cleanup <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>debug <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>log<span class="op">.</span><span class="fu">info</span> <span class="st">"""</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="st">====================================================</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="st">PARAMETERS</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="st">====================================================</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="st">batches                     : </span><span class="ss">${</span>params<span class="op">.</span>batches<span class="ss">}</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="st">model specification         : </span><span class="ss">${</span>params<span class="op">.</span>meta<span class="ss">}</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="st">school data                 : </span><span class="ss">${</span>params<span class="op">.</span>school_data<span class="ss">}</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="st">school info                 : </span><span class="ss">${</span>params<span class="op">.</span>school_info<span class="ss">}</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="st">composition data            : </span><span class="ss">${</span>params<span class="op">.</span>composition_data<span class="ss">}</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="st">effects                     : </span><span class="ss">${</span>params<span class="op">.</span>effects<span class="ss">}</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="st">subgroup                    : </span><span class="ss">${</span>params<span class="op">.</span>subgroup<span class="ss">}</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>params<span class="op">.</span>help<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>    log<span class="op">.</span><span class="fu">info</span> <span class="st">'This is the the siena pipeline'</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>    log<span class="op">.</span><span class="fu">info</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>    exit <span class="dv">1</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="st">/*</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="st">========================================================================================</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="st">    Workflow parameters are written as params.&lt;parameter&gt;</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="st">    and can be initialised using the `=` operator.</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="st">========================================================================================</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="st">*/</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>meta<span class="op">)</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitCsv</span><span class="op">(</span>header<span class="op">:</span> <span class="kw">false</span><span class="op">,</span> sep<span class="op">:</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span><span class="op">)</span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_meta <span class="op">}</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>subgroup<span class="op">)</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitCsv</span><span class="op">(</span>header<span class="op">:</span> <span class="kw">false</span><span class="op">,</span> sep<span class="op">:</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span><span class="op">)</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_subgroup <span class="op">}</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="dt">def</span> <span class="fu">map_join</span><span class="op">(</span>channel_a<span class="op">,</span> key<span class="op">,</span> value<span class="op">){</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>    channel_a</span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span><span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="st">'key'</span><span class="op">],</span> it<span class="op">[</span><span class="st">'value'</span><span class="op">]]</span> <span class="op">}</span></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="dt">def</span> <span class="fu">flatten_estimation</span><span class="op">(</span>channel_estimation<span class="op">){</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>    channel_estimation</span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span><span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">][</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">][</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> it<span class="op">[</span><span class="dv">5</span><span class="op">][</span><span class="dv">1</span><span class="op">]]</span> <span class="op">}</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="co">// Create a channel for values</span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>effects<span class="op">)</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitCsv</span><span class="op">(</span>header<span class="op">:</span> <span class="kw">false</span><span class="op">)</span></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span> <span class="op">{</span> row <span class="op">-&gt;</span> <span class="op">[</span>row<span class="op">[</span><span class="dv">0</span><span class="op">],</span> row<span class="op">[</span><span class="dv">1</span><span class="op">],</span> row<span class="op">[</span><span class="fl">2.</span><span class="op">.-</span><span class="dv">1</span><span class="op">]]</span> <span class="op">}</span></span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_effects <span class="op">}</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>school_info<span class="op">)</span></span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitJson</span><span class="op">()</span></span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_school_info <span class="op">}</span></span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a><span class="st">/*</span></span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a><span class="st">========================================================================================</span></span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a><span class="st">    Input data is received through channels</span></span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a><span class="st">========================================================================================</span></span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a><span class="st">*/</span></span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a><span class="co">//import modules</span></span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a><span class="dt">def</span> ZipChannel_dat <span class="op">=</span> <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>composition_data<span class="op">)</span> <span class="co">// change this to composition_sub whenever data file name changes</span></span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a></span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a><span class="co">========================================================================================</span></span>
<span id="cb3-95"><a href="#cb3-95" tabindex="-1"></a><span class="co">   Main Workflow</span></span>
<span id="cb3-96"><a href="#cb3-96" tabindex="-1"></a><span class="co">========================================================================================</span></span>
<span id="cb3-97"><a href="#cb3-97" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb3-98"><a href="#cb3-98" tabindex="-1"></a></span>
<span id="cb3-99"><a href="#cb3-99" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb3-100"><a href="#cb3-100" tabindex="-1"></a></span>
<span id="cb3-101"><a href="#cb3-101" tabindex="-1"></a>    composition <span class="op">=</span> <span class="fu">GENERATE_READS</span><span class="op">(</span>ZipChannel_dat<span class="op">)</span></span>
<span id="cb3-102"><a href="#cb3-102" tabindex="-1"></a>    <span class="op">|</span> flatten \</span>
<span id="cb3-103"><a href="#cb3-103" tabindex="-1"></a>    <span class="op">|</span> map <span class="op">{</span> file <span class="op">-&gt;</span></span>
<span id="cb3-104"><a href="#cb3-104" tabindex="-1"></a>    <span class="dt">def</span> key <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">'</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb3-105"><a href="#cb3-105" tabindex="-1"></a>    <span class="dt">def</span> school_ID <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"_|</span><span class="sc">\\</span><span class="st">."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb3-106"><a href="#cb3-106" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">tuple</span><span class="op">(</span>school_ID<span class="op">,</span> key<span class="op">,</span> file<span class="op">)}</span></span>
<span id="cb3-107"><a href="#cb3-107" tabindex="-1"></a></span>
<span id="cb3-108"><a href="#cb3-108" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" tabindex="-1"></a>    pipe_meta<span class="op">.</span><span class="fu">view</span><span class="op">()</span></span>
<span id="cb3-110"><a href="#cb3-110" tabindex="-1"></a>    <span class="co">// pipe_school_info.view()</span></span>
<span id="cb3-111"><a href="#cb3-111" tabindex="-1"></a>    <span class="co">// pipe_effects.view()</span></span>
<span id="cb3-112"><a href="#cb3-112" tabindex="-1"></a>    <span class="co">// pipe_subgroup.view()</span></span>
<span id="cb3-113"><a href="#cb3-113" tabindex="-1"></a></span>
<span id="cb3-114"><a href="#cb3-114" tabindex="-1"></a></span>
<span id="cb3-115"><a href="#cb3-115" tabindex="-1"></a>    <span class="co">// composition.view()</span></span>
<span id="cb3-116"><a href="#cb3-116" tabindex="-1"></a></span>
<span id="cb3-117"><a href="#cb3-117" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-118"><a href="#cb3-118" tabindex="-1"></a></span>
<span id="cb3-119"><a href="#cb3-119" tabindex="-1"></a><span class="st">/*</span></span>
<span id="cb3-120"><a href="#cb3-120" tabindex="-1"></a><span class="st">========================================================================================</span></span>
<span id="cb3-121"><a href="#cb3-121" tabindex="-1"></a><span class="st">    A Nextflow process block. Process names are written, by convention, in uppercase.</span></span>
<span id="cb3-122"><a href="#cb3-122" tabindex="-1"></a><span class="st">    This convention is used to enhance workflow readability.</span></span>
<span id="cb3-123"><a href="#cb3-123" tabindex="-1"></a><span class="st">========================================================================================</span></span>
<span id="cb3-124"><a href="#cb3-124" tabindex="-1"></a><span class="st">*/</span></span>
<span id="cb3-125"><a href="#cb3-125" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" tabindex="-1"></a>process GENERATE_READS<span class="op">{</span></span>
<span id="cb3-127"><a href="#cb3-127" tabindex="-1"></a></span>
<span id="cb3-128"><a href="#cb3-128" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb3-129"><a href="#cb3-129" tabindex="-1"></a>          path targz</span>
<span id="cb3-130"><a href="#cb3-130" tabindex="-1"></a></span>
<span id="cb3-131"><a href="#cb3-131" tabindex="-1"></a>  publishDir <span class="st">"</span><span class="ss">$projectDir</span><span class="st">/tmp"</span><span class="op">,</span> mode<span class="op">:</span> <span class="st">"copy"</span><span class="op">,</span> overwrite<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb3-132"><a href="#cb3-132" tabindex="-1"></a></span>
<span id="cb3-133"><a href="#cb3-133" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb3-134"><a href="#cb3-134" tabindex="-1"></a>          path <span class="st">"*"</span></span>
<span id="cb3-135"><a href="#cb3-135" tabindex="-1"></a></span>
<span id="cb3-136"><a href="#cb3-136" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb3-137"><a href="#cb3-137" tabindex="-1"></a>          <span class="st">"""</span></span>
<span id="cb3-138"><a href="#cb3-138" tabindex="-1"></a><span class="st">          tar -xzf </span><span class="ss">$targz</span></span>
<span id="cb3-139"><a href="#cb3-139" tabindex="-1"></a><span class="st">          # Print file name</span></span>
<span id="cb3-140"><a href="#cb3-140" tabindex="-1"></a><span class="st">          printf '</span><span class="ss">${</span>targz<span class="ss">}</span><span class="sc">\\</span><span class="st">t'</span></span>
<span id="cb3-141"><a href="#cb3-141" tabindex="-1"></a><span class="st">          """</span></span>
<span id="cb3-142"><a href="#cb3-142" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
<p>Run the code using the following command on the terminal:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> nextflow run 04_channels.nf</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>The <strong>fromFilePairs</strong> Channel
factory</strong></p>
<p>We have seen how to process files individually using
<code>fromPath</code>.</p>
<p>Another alternative is to use <code>fromFilePairs</code> to return a
grouping of data, represented as a list in the groovy syntax.</p>
<ol style="list-style-type: decimal">
<li>The first element of the tuple emitted is a string based on the
shared part of the filenames (i.e., the <code>*</code> part of the glob
pattern).</li>
<li>The second element is the list of files matching the remaining part
of the glob pattern (i.e., the <code>*each_period.tar.gz</code>
pattern). This will include any sets of data that involve compressed
folders.</li>
</ol>
<p><strong>What if you want to capture more than a pair?</strong></p>
<p>If you want to capture more than two files for a pattern you will
need to change the default <code>size</code> argument (the default value
is 2) to the number of expected matching files.</p>
<p>The code above will create a queue channel containing one
element.</p>
<p>See more information about the channel factory
<code>fromFilePairs</code> <a href="https://www.nextflow.io/docs/latest/channel.html#fromfilepairs" class="external-link">here</a></p>
<div id="task-4.4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-4.4" class="callout-inner">
<h3 class="callout-title">Task 4.4</h3>
<div class="callout-content">
<p>Use the <code>fromFilePairs</code> method to create a channel
containing four tuples. Each tuple will contain the pairs of data reads
for the four schools with synthetic data in the <code>tmp/</code>
directory. Make sure you have previously completed Task 3.3, or check
your <code>tmp/</code> folder contains both data files,
<code>.RDS</code>, as well as auxiliary data files,
<code>.dat</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">//04_channels.nf</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    channel</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromFilePairs</span><span class="op">(</span><span class="st">"</span><span class="ss">${</span>launchDir<span class="ss">}</span><span class="st">/tmp/school*_period*.{RDS,dat}"</span><span class="op">)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">view</span><span class="op">()</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
[school123_period2, [/workspaces/training/sgsss-workflow/scripts/tmp/school123_period2.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school123_period2.dat]]
[school124_period2, [/workspaces/training/sgsss-workflow/scripts/tmp/school124_period2.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school124_period2.dat]]
[school126_period1, [/workspaces/training/sgsss-workflow/scripts/tmp/school126_period1.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school126_period1.dat]]
[school124_period1, [/workspaces/training/sgsss-workflow/scripts/tmp/school124_period1.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school124_period1.dat]]
[school125_period1, [/workspaces/training/sgsss-workflow/scripts/tmp/school125_period1.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school125_period1.dat]]
[school123_period1, [/workspaces/training/sgsss-workflow/scripts/tmp/school123_period1.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school123_period1.dat]]
[school126_period2, [/workspaces/training/sgsss-workflow/scripts/tmp/school126_period2.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school126_period2.dat]]
[school125_period2, [/workspaces/training/sgsss-workflow/scripts/tmp/school125_period2.RDS, /workspaces/training/sgsss-workflow/scripts/tmp/school125_period2.dat]]
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Channels must be used to import data into Nextflow.</li>
<li>Nextflow has two different kinds of channels: queue channels and
value channels.</li>
<li>Data in value channels can be used multiple times in workflow.</li>
<li>Data in queue channels are consumed when they are used by a process
or an operator.</li>
<li>Channel factory methods, such as <code>Channel.of</code>, are used
to create channels.</li>
<li>Channel factory methods have optional parameters e.g.,
<code>checkIfExists</code>, that can be used to alter the creation and
behaviour of a channel.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-05"><p>Content from <a href="05.html">Modules</a></p>
<hr>
<p>Last updated on 2025-07-05 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/05.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I run tasks/modulees in Nextflow?</li>
<li>How do I get data, files and values, into a module?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how Nextflow uses modulees to implement tasks.</li>
<li>Create a Nextflow module.</li>
<li>Define inputs to a module.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="modules">Modules<a class="anchor" aria-label="anchor" href="#modules"></a>
</h2>
<hr class="half-width">
<p>We now know how to create and use Channels to send data around a
workflow. We will now see how to run tasks within a workflow using
modulees. Modules are nextflow scripts that can include definitions
(workflows, processes, and functions).</p>
<p>A <code>module</code> is the way Nextflow implements commands you
would run on the command line or custom scripts.</p>
<p>Here we focus on how defining processes within a module. A process
can be thought of as a particular step in a workflow, e.g.¬†data
wrangling for analysis. Modules are independent of each other (don‚Äôt
require any another module to implement) and can not communicate/write
to each other. Data is passed between modulees via input and output
Channels.</p>
<p>For example, we previously saw the process
<code>GENERATE_READS</code> can accept multiple files as inputs. In the
previous episodes we saw examples of combinations of inputs,
<code>each_period.tar.gz</code> and
<code>comopsition_each_period.tar.gz</code>. Specifically in Task 4.3 we
used the <code>channel.fromFilePairs()</code> to generate tuples of
inputs with file names, including both data and auxiliary data
files.</p>
<p>Now we will show how to convert this into a simple Nextflow
module.</p>
</section><section><h2 class="section-heading" id="process-definition">Process definition<a class="anchor" aria-label="anchor" href="#process-definition"></a>
</h2>
<hr class="half-width">
<p>The module definition starts with keyword <code>module</code>,
followed by module name, in this case <code>GENERATE_READS</code>, and
finally the module <code>body</code> delimited by curly brackets
<code>{}</code>. The module body must contain a string which represents
the command or, more generally, a script that is implemented by it.</p>
<div id="implicit-variables" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="implicit-variables" class="callout-inner">
<h3 class="callout-title">Implicit variables</h3>
<div class="callout-content">
<p>We use the Nextflow implicit variable <code>${projectDir}</code> to
specify the directory where the main script is located. This is
important as Nextflow scripts are implemented in a separate working
directory. A full list of implicit variables can be found <a href="https://www.nextflow.io/docs/latest/script.html?highlight=implicit%20variables#implicit-variables" class="external-link">here</a>.</p>
</div>
</div>
</div>
<p>To add the module to a workflow, add a <code>workflow</code> block,
and call the module like a function. We will learn more about the
<code>workflow</code> block in the workflow episode. We can now run the
module:</p>
<p><strong>Note</strong> We need to add the Nextflow run option
<code>--module.debug</code> to print the output to the terminal.</p>
<div id="task-5.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-5.1" class="callout-inner">
<h3 class="callout-title">Task 5.1</h3>
<div class="callout-content">
<p>Open the Nextflow script <code>05_modules.nf</code> navigate to the
module definition section. You notice there is now a reference to a
module <code>GENERATE_READS</code>. Where is the process defined? How
many times is the process used in the workflow?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Essentially this stores the process definition for
<code>GENERATE_READS</code>. Note previously we defined the process in
the same file as our workflow, without having to fall back on a module.
It is generally good practice to organise code into modules, and store
these in the same folder. This is really helpful whenever we re-use a
process for a different purpose. Generally we can only use a process
once, if we need to repurpose a process, we‚Äôll need to make sure to
assign an alias to each instance we refer to this. This is where modules
come handy as we can separate each set of code.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">//import modules </span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>include <span class="op">{</span> GENERATE_READS <span class="kw">as</span> GENERATE_RDS<span class="op">}</span> from <span class="st">'./modules/generate_reads/'</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>include <span class="op">{</span> GENERATE_READS <span class="kw">as</span> GENERATE_DAT<span class="op">}</span> from <span class="st">'./modules/generate_reads/'</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="dt">def</span> ZipChannel_dat <span class="op">=</span> <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>composition_data<span class="op">)</span> <span class="co">// change this to composition_sub whenever data file name changes</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="dt">def</span> ZipChannel_RDS <span class="op">=</span> <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>school_data<span class="op">)</span> <span class="co">// change this multi_period_sub whenever data file name changes</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    dataset <span class="op">=</span>  <span class="fu">GENERATE_DAT</span><span class="op">(</span>ZipChannel_RDS<span class="op">)</span> \</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    <span class="op">|</span> flatten \</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    <span class="op">|</span> map <span class="op">{</span> file <span class="op">-&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="dt">def</span> key <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">'</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    <span class="dt">def</span> school_ID <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"_|</span><span class="sc">\\</span><span class="st">."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">tuple</span><span class="op">(</span>school_ID<span class="op">,</span> key<span class="op">,</span> file<span class="op">)}</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>    </span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>    composition <span class="op">=</span> <span class="fu">GENERATE_RDS</span><span class="op">(</span>ZipChannel_dat<span class="op">)</span> </span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>    <span class="op">|</span> flatten \</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>    <span class="op">|</span> map <span class="op">{</span> file <span class="op">-&gt;</span> </span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>    <span class="dt">def</span> key <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">'</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>    <span class="dt">def</span> school_ID <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"_|</span><span class="sc">\\</span><span class="st">."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">tuple</span><span class="op">(</span>school_ID<span class="op">,</span> key<span class="op">,</span> file<span class="op">)}</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="definition-blocks">Definition blocks<a class="anchor" aria-label="anchor" href="#definition-blocks"></a>
</h3>
<p>The previous example was a simple <code>module</code> with no defined
inputs and outputs that ran only once. To control inputs, outputs and
how a command is implemented a module may contain five definition
blocks:</p>
<ol style="list-style-type: decimal">
<li>
<strong>directives - 0, 1, or more</strong>: allow the definition of
optional settings that affect the execution of the current module
e.g.¬†the number of cpus a task uses and the amount of memory
allocated.</li>
<li>
<strong>inputs - 0, 1, or more</strong>: Define the input
dependencies, usually channels, which determines the number of times a
module is implemented.</li>
<li>
<strong>outputs - 0, 1, or more</strong>: Defines the output
channels used by the module to send results/data produced by the
module.</li>
<li>
<strong>when clause - optional</strong>: Allows you to define a
condition that must be verified in order to implement the module.</li>
<li>
<strong>script block - required</strong>: A statement within quotes
that defines the commands that are implemented by the module to carry
out its task.</li>
</ol>
<p>The syntax is defined as follows:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>module <span class="op">&lt;</span> NAME <span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="op">[</span> directives <span class="op">]</span>        </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  input<span class="op">:</span>                </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="op">&lt;</span> module inputs <span class="op">&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  output<span class="op">:</span>               </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="op">&lt;</span> module outputs <span class="op">&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  when<span class="op">:</span>                 </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="op">&lt;</span> condition <span class="op">&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="op">[</span>script<span class="op">|</span>shell<span class="op">|</span>exec<span class="op">]:</span>  </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="op">&lt;</span> user script to be implemented <span class="op">&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="script">Script<a class="anchor" aria-label="anchor" href="#script"></a>
</h2>
<hr class="half-width">
<p>At minimum a module block must contain a <code>script</code>
block.</p>
<p>The <code>script</code> block is a String ‚Äústatement‚Äù that defines
the command that is implemented by the module to carry out its task.
These are normally the commands you would run on a terminal.</p>
<p>A module contains only one <code>script</code> block, and it must be
the last statement when the module contains <code>input</code> and
<code>output</code> declarations.</p>
<p>The <code>script</code> block can be a simple one line string in
quotes.</p>
<p>Or, for commands that span multiple lines you can encase the command
in triple quotes <code>"""</code>.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>The following section on python is meant to be run by the instructor
not the learners. It is meant to be a demonstration of the different
ways to run a module. This can be skipped for time.</p>
</div>
</div>
</div>
</div>
<p>By default the module command is interpreted as a
<strong>Bash</strong> script. However, any other scripting language can
be used just simply starting the script with the corresponding <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)" class="external-link">Shebang</a>
declaration.</p>
<p>This allows the use of a different programming languages which may
better fit a particular job. However, for large chunks of code it is
suggested to save them into separate files and invoke them from the
module script.</p>
<div id="associated-scripts" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="associated-scripts" class="callout-inner">
<h3 class="callout-title">Associated scripts</h3>
<div class="callout-content">
<p>Scripts such as the one in the example above,
<code>siena07RunSimOnly.R</code>, can be stored in a <code>bin</code>
folder at the same directory level as the Nextflow workflow script that
invokes them, and permission to run files. Nextflow will automatically
add this folder to the <code>PATH</code> environment variable. To invoke
the script in a Nextflow module, simply use its filename on its own
rather than invoking the interpreter
e.g.¬†<code>siena07RunSimOnly.R</code> instead of
<code>R siena07RunSimOnly.R</code>. <strong>Note</strong> The script
<code>siena07RunSimOnly.R</code> must be executable to run.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="script-parameters">Script parameters<a class="anchor" aria-label="anchor" href="#script-parameters"></a>
</h3>
<p>The command in the <code>script</code> block can be defined
dynamically using Nextflow variables e.g.¬†<code>${projectDir}</code>. To
reference a variable in the script block you can use the <code>$</code>
in front of the Nextflow variable name, and additionally you can add
<code>{}</code> around the variable name
e.g.¬†<code>${projectDir}</code>.</p>
<div id="variable-substitutions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="variable-substitutions" class="callout-inner">
<h3 class="callout-title">Variable substitutions</h3>
<div class="callout-content">
<p>Similar to bash scripting Nextflow uses the <code>$</code> character
to introduce variable substitutions. The variable name to be expanded
may be enclosed in braces <code>{variable_name}</code>, which are
optional but serve to protect the variable to be expanded from
characters immediately following it which could be interpreted as part
of the name. It is a good rule of thumb to always use the
<code>{}</code> syntax because it enhances readability and clarity,
ensures correct variable interpretation, and prevents potential syntax
errors in complex expressions. Note the <code>$</code> symbol is
reserved for Nextflow variables, if you use this in e.g your R script
code, you will either need to escape the reserved character with
<code>\$</code> or preferably use different syntax to index a
variable.</p>
</div>
</div>
</div>
<p>We saw in section 02 most cases we do not want to hard code parameter
values. We saw in the parameter episode the use of a special Nextflow
variable <code>params</code> that can be used to assign values from the
command line. You would do this by adding a key name to the params
variable and specifying a value, like
<code>params.keyname = value</code></p>
<p><strong>Note:</strong> parameters to the workflow can be specified
through the command line with two hyphens <code>--</code>.</p>
<div id="task-5.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-5.2" class="callout-inner">
<h3 class="callout-title">Task 5.2</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">nextflow</span> run 05_modules.nf <span class="at">--module.debug</span></span></code></pre>
</div>
<p><strong>Note:</strong> The Nextflow option
<code>--module.debug</code> will print the module‚Äôs standard output to
the terminal.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
executor &gt;  local (2)
[1b/fac7c3] process &gt; GENERATE_DAT (1) [100%] 1 of 1 ‚úî
[cc/96a9e1] process &gt; GENERATE_RDS (1) [100%] 1 of 1 ‚úî
[school123, 56]
[school124, 88]
[school125, 55]
[school126, 55]
Pipeline completed!
Started at  2025-06-26T12:42:32.047860197Z
Finished at 2025-06-26T12:42:35.178956448Z
Time elapsed: 3.1s
Execution status: OK
</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="bash-variables">Bash variables<a class="anchor" aria-label="anchor" href="#bash-variables"></a>
</h3>
<p>Nextflow uses the same Bash syntax for variable substitutions,
<code>$variable</code>, in strings. However, Bash variables need to be
escaped using <code>\</code> character in front of
<code>\$variable</code> name.</p>
</div>
</section><section><h2 class="section-heading" id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h2>
<hr class="half-width">
<p>Modules are isolated from each other but can communicate by sending
values and files via Nextflow channels from <code>input</code> and into
<code>output</code> blocks.</p>
<p>The <code>input</code> block defines which channels the module is
expecting to receive input from. The number of elements in input
channels determines the module dependencies and the number of times a
module is run.</p>
<figure><img src="../fig/channel-process.png" alt="Process Flow" class="figure mx-auto d-block"><div class="figcaption">Process Flow</div>
</figure><p>You can only define one input block at a time and it must contain one
or more input declarations.</p>
<p>The input block follows the syntax shown below:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>input<span class="op">:</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="op">&lt;</span>input qualifier<span class="op">&gt;</span> <span class="op">&lt;</span>input name<span class="op">&gt;</span></span></code></pre>
</div>
<p>The input qualifier declares the type of data to be received.</p>
<div id="input-qualifiers" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="input-qualifiers" class="callout-inner">
<h3 class="callout-title">Input qualifiers</h3>
<div class="callout-content">
<ul>
<li>
<code>val</code>: Lets you access the received input value by its
name as a variable in the module script.</li>
<li>
<code>env</code>: Lets you use the input value to set an environment
variable named as the specified input name.</li>
<li>
<code>path</code>: Lets you handle the received value as a file,
staging the file properly in the execution context.</li>
<li>
<code>stdin</code>: Lets you forward the received value to the
module stdin special file.</li>
<li>
<code>tuple</code>: Lets you handle a group of input values having
one of the above qualifiers.</li>
<li>
<code>each</code>: Lets you implement the module for each entry in
the input collection. A complete list of inputs can be found <a href="https://www.nextflow.io/docs/latest/module.html#inputs" class="external-link">here</a>.</li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="input-values">Input values<a class="anchor" aria-label="anchor" href="#input-values"></a>
</h3>
<p>The <code>val</code> qualifier allows you to receive value data as
input. It can be accessed in the module script by using the specified
input name, as shown in the following example:</p>
<p>In the above example the module is implemented 1 time; each time a
value is received from the queue channel <code>composition</code> it is
used to run the module.</p>
<div id="channel-order" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="channel-order" class="callout-inner">
<h3 class="callout-title">Channel order</h3>
<div class="callout-content">
<p>The channel guarantees that items are delivered in the same order as
they have been sent, but since the module is implemented in a parallel
manner, there is no guarantee on the order.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="input-files">Input files<a class="anchor" aria-label="anchor" href="#input-files"></a>
</h3>
<p>When you need to handle files as input, you need the
<code>path</code> qualifier. Using the <code>path</code> qualifier means
that Nextflow will stage it in the module directory, and it can be
accessed in the script by using the name specified in the input
declaration.</p>
<p>The input file name can be defined dynamically by defining the input
name as a Nextflow variable and referenced in the script using the
<code>$variable_name</code> syntax.</p>
<p>For example, in the script below, we assign the variable name
<code>read</code> to the input files using the <code>path</code>
qualifier.</p>
<p>In this way we can use a <code>shell</code> block definition instead
of <code>script</code>, for a trivial process such as extracting files
from a folder. When using the <code>shell</code> statement Bash
variables are referenced in the normal way
<code>$my_bash_variable</code>. However, the <code>shell</code>
statement uses a different syntax for Nextflow variable substitutions:
<code>!{nextflow_variable}</code>, which is needed to use both Nextflow
and Bash variables in the same script.</p>
<p>In the <code>GENERATE_READS</code> module definition file we set a
bash variable <code>$targz</code>. The variable was used to reference
the input file path. Previously, in episode 3, we also printed the file
path using <code>printf '${targz}\\t'</code> in our script block.</p>
<p>Recall the example in the script <code>03_params.nf</code>
demonstrated use of a Bash variable, <code>${targz}</code>.</p>
<div id="callout6" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The input name can also be defined as a user-specified filename
inside quotes. For example, in the script below, the name of the file is
specified as <code>'each_period.tar.gz'</code> in the input definition
and can be referenced by that name in the script block.</p>
</div>
</div>
</div>
<div id="file-objects-as-inputs" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="file-objects-as-inputs" class="callout-inner">
<h3 class="callout-title">File Objects as inputs</h3>
<div class="callout-content">
<p>When a module declares an input file, the corresponding channel
elements must be file objects, i.e.¬†created with the path helper
function from the file specific channel factories,
e.g.¬†<code>Channel.fromPath</code> or
<code>Channel.fromFilePairs</code>. We saw examples for this in a
previous <a href="https://omiridoue.github.io/sgsss-workflow/03.html" class="external-link">episode</a>.</p>
</div>
</div>
</div>
<div id="task-5.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-5.3" class="callout-inner">
<h3 class="callout-title">Task 5.3</h3>
<div class="callout-content">
<p>For the script <code>05_modules.nf</code>:</p>
<ol style="list-style-type: decimal">
<li>Identify the names of the Channels using <code>fromPath</code> for
the <code>params.school_data</code> and
<code>params.composition_data</code>. By definition are these queue or
value channels?</li>
<li>Explain the role of the map closure <code>{}</code>, how many
outputs do the channels <code>composition</code> and
<code>dataset</code> <em>return</em> ?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>The names for the two queue channels are <code>ZipChannel_dat</code>
and <code>ZipChannel_RDS</code> and are defined with the following
code:</li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">//05_modules.nf</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="dt">def</span> ZipChannel_dat <span class="op">=</span> <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>composition_data<span class="op">)</span> </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="dt">def</span> ZipChannel_RDS <span class="op">=</span> <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>school_data<span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>The map closure is a type of function operating on the output of a
Channel. Just like a function you return select values using the return
statement at the end of the function. In this case we return a tuple
with three self-explanatory items, the first two involve values and the
third is a file path, <code>tuple(school_ID, key, file)</code>. A close
alternative is the <code>Channel.fromFilePairs()</code> which is a good
option for combining two separate data types.</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">//05_modules.nf</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    composition <span class="op">=</span> <span class="fu">GENERATE_RDS</span><span class="op">(</span>ZipChannel_dat<span class="op">)</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="op">|</span> flatten \</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="op">|</span> map <span class="op">{</span> file <span class="op">-&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="dt">def</span> key <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">'</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="dt">def</span> school_ID <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"_|</span><span class="sc">\\</span><span class="st">."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">tuple</span><span class="op">(</span>school_ID<span class="op">,</span> key<span class="op">,</span> file<span class="op">)}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="combining-input-channels">Combining input channels<a class="anchor" aria-label="anchor" href="#combining-input-channels"></a>
</h3>
<p>A key feature of modulees is the ability to handle inputs from
multiple channels. However, it‚Äôs important to understand how the number
of items within the multiple channels affect the execution of a
module.</p>
<div id="task-5.4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-5.4" class="callout-inner">
<h3 class="callout-title">Task 5.4</h3>
<div class="callout-content">
<p>How is the output from either channel wrangled in the queue channel?
Could you think of an alternative channel definition that could
replicate the combination of a pair of channels?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>The channel operator <strong>combine</strong> is used to combine the
main process output <code>dataset</code> and the process output
<code>composition</code>. We combine, or merge the two based on the
second item in the tuple, i.e <code>key</code>. It is important to note
that the counter for indexing tuples or lists in Nextflow starts from 0
rather than 1.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">//05_modules.nf</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>   <span class="op">.</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>   <span class="op">.</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>   <span class="op">.</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    estimation_channel <span class="op">=</span> composition \</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">combine</span><span class="op">(</span>dataset<span class="op">,</span> by<span class="op">:</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>   <span class="op">.</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>   <span class="op">.</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>   <span class="op">.</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>What is happening is that the module waits until it receives an input
value from all the queue channels declared as input.</p>
<p>When this condition is verified, it uses up the input values coming
from the respective queue channels, runs the task. This logic repeats
until one or more queue channels have no more content. The module then
stops.</p>
<p>What happens when not all channels have the same number of
elements?</p>
<p>In the above example the module is implemented only two times,
because when a queue channel has no more data, it stops the module
execution.</p>
</div>
<div class="section level3">
<h3 id="value-channels-and-module-termination">Value channels and module termination<a class="anchor" aria-label="anchor" href="#value-channels-and-module-termination"></a>
</h3>
<p><strong>Note</strong> however that value channels,
<code>Channel.value</code>, do not affect the module termination.</p>
<p>To better understand this behaviour, compare the previous example
with the following one:</p>
<div id="task-5.5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-5.5" class="callout-inner">
<h3 class="callout-title">Task 5.5</h3>
<div class="callout-content">
<p>Open the nextflow script <code>05_modules.nf</code> that combines two
input channels.</p>
<p>Identify the map_join closure and inspect the output of this returns
whenever it operates on the combined output of the dataset and auxiliary
data channels.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">// 05_modules.nf</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="dt">def</span> <span class="fu">map_join</span><span class="op">(</span>channel_a<span class="op">,</span> key<span class="op">,</span> value<span class="op">){</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    channel_a</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>        <span class="op">.</span><span class="fu">map</span><span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="st">'key'</span><span class="op">],</span> it<span class="op">[</span><span class="st">'value'</span><span class="op">]]</span> <span class="op">}</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="fu">workflow</span> <span class="op">{</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>    estimation_channel<span class="op">.</span><span class="fu">view</span><span class="op">()</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>    mapped_params <span class="op">=</span> <span class="fu">map_join</span><span class="op">(</span>pipe_school_info<span class="op">,</span> <span class="st">'key'</span><span class="op">,</span> <span class="st">'value'</span><span class="op">)</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>    mapped_params<span class="op">.</span><span class="fu">view</span><span class="op">()</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="input-repeaters">Input repeaters<a class="anchor" aria-label="anchor" href="#input-repeaters"></a>
</h2>
<hr class="half-width">
<p>We saw previously that by default the number of times a module runs
is defined by the queue channel with the fewest items. However, the
<code>each</code> qualifier allows you to repeat a module for each item
in a list or a queue channel, every time new data is received. The
material here simply motivates there is a sufficient number of options
to wrangle the inputs and outputs of a process to suit objectives.
Explore more information in the <a href="https://nextflow.io/docs/latest/process.html" class="external-link">Nextflow
documentation</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A Nextflow module is an independent step in a workflow.</li>
<li>Modules contain up to five definition blocks including: directives,
inputs, outputs, when clause and finally a script block.</li>
<li>The script block contains the commands you would like to run.</li>
<li>A module should have a script but the other four blocks are
optional.</li>
<li>Inputs are defined in the input block with a type qualifier and a
name.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-06"><p>Content from <a href="06.html">Modules Part 2</a></p>
<hr>
<p>Last updated on 2025-07-05 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/06.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I get data, files, and values, out of processes?</li>
<li>How do I handle grouped input and output?</li>
<li>How can I control when a process is implemented?</li>
<li>How do I control resources, such as number of CPUs and memory,
available to processes?</li>
<li>How do I save output/results from a process?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define outputs to a process.</li>
<li>Understand how to handle grouped input and output using the tuple
qualifier.</li>
<li>Understand how to use conditionals to control process
execution.</li>
<li>Use process directives to control execution of a process.</li>
<li>Use the <code>publishDir</code> directive to save result files to a
directory.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h2>
<hr class="half-width">
<p>We have seen how to input data into a process; now we will see how to
output files and values from a process.</p>
<p>The <code>output</code> declaration block allows us to define the
channels used by the process to send out the files and values
produced.</p>
<p>An output block is not required, but if it is present it can contain
one or more output declarations.</p>
<p>The output block follows the syntax shown below:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>output<span class="op">:</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="op">&lt;</span>output qualifier<span class="op">&gt;</span> <span class="op">&lt;</span>output name<span class="op">&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="op">&lt;</span>output qualifier<span class="op">&gt;</span> <span class="op">&lt;</span>output name<span class="op">&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="op">...</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="output-values">Output values<a class="anchor" aria-label="anchor" href="#output-values"></a>
</h4>
<p>Like the input, the type of output data is defined using type
qualifiers.</p>
<p>The <code>val</code> qualifier allows us to output a value defined in
the script.</p>
<p>Because Nextflow processes can only communicate through channels, if
we want to share a value output of one process as input to another
process, we would need to define that value in the output declaration
block.</p>
</div>
<div class="section level4">
<h4 id="output-files">Output files<a class="anchor" aria-label="anchor" href="#output-files"></a>
</h4>
<p>If we want to capture a file instead of a value as output we can use
the <code>path</code> qualifier that can capture one or more files
produced by the process, over the specified channel.</p>
<p>In the file <code>06_modules_optional.nf</code> the process
<code>ESTIMATION</code> creates a file named
<code>&lt;chr&gt;_SIM.RDS</code> in the work directory containing the
output from simulation run after n iterations, required for this to
converge.</p>
<p>Since a file parameter using the same name,
<code>&lt;chr&gt;_SIM.RDS</code>, is declared in the output block, when
the task is completed that file is sent over the output channel.</p>
<p>A downstream <code>operator</code>, such as <code>.view</code> or a
<code>process</code> declaring the same channel as input will be able to
receive it.</p>
</div>
<div class="section level4">
<h4 id="multiple-output-files">Multiple output files<a class="anchor" aria-label="anchor" href="#multiple-output-files"></a>
</h4>
<p>When an output file name contains a <code>*</code> or <code>?</code>
metacharacter it is interpreted as a pattern match. This allows us to
capture multiple files into a list and output them as a one item
channel.</p>
<p><strong>Note:</strong> There are some caveats on glob pattern
behaviour:</p>
<ul>
<li>Input files are not included in the list of possible matches.</li>
<li>Glob pattern matches against both files and directories path.</li>
<li>When a two stars pattern <code>**</code> is used to recurse through
subdirectories, only file paths are matched i.e.¬†directories are not
included in the result list.</li>
</ul>
</div>
<div class="section level4">
<h4 id="grouped-inputs-and-outputs">Grouped inputs and outputs<a class="anchor" aria-label="anchor" href="#grouped-inputs-and-outputs"></a>
</h4>
<p>So far we have seen how to declare multiple input and output
channels, but each channel was handling only one value at time. However
Nextflow can handle groups of values using the <code>tuple</code>
qualifiers.</p>
<p>In tuples the first item is the grouping key and the second item is
the list.</p>
<p>When using channel containing a tuple, such one created with
<code>.filesFromPairs</code> factory method.</p>
<p>In the same manner an output channel containing tuple of values can
be declared using the <code>tuple</code> qualifier following by the
definition of each tuple element in the tuple.</p>
</div>
<div class="section level4">
<h4 id="conditional-script-execution">Conditional script execution<a class="anchor" aria-label="anchor" href="#conditional-script-execution"></a>
</h4>
<p>Sometimes you want to change how a module is run depending on some
condition. In Nextflow scripts we can use conditional statements such as
the <code>if</code> statement or any other expression evaluating to
boolean value <code>true</code> or <code>false</code>.</p>
</div>
<div class="section level4">
<h4 id="if-statement">If statement<a class="anchor" aria-label="anchor" href="#if-statement"></a>
</h4>
<p>The <code>if</code> statement uses the same syntax common to other
programming languages such Java, C, JavaScript, etc.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span> <span class="op">&lt;</span> <span class="dt">boolean</span> expression <span class="op">&gt;</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    <span class="co">// true branch</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span> <span class="op">&lt;</span> <span class="dt">boolean</span> expression <span class="op">&gt;</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="co">// true branch</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="cf">else</span> <span class="op">{</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="co">// false branch</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
<p>For example, the Nextflow script below will use the <code>if</code>
and <code>else if</code> pattern of statements to change what the
<code>ESTIMATION</code> module counts depending on an input.</p>
<div id="task-6.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-6.1" class="callout-inner">
<h3 class="callout-title">Task 6.1</h3>
<div class="callout-content">
<p>Inspect the module <code>ESTIMATION</code>, what is the name of the
input variable that is used by the workflow to evaluate a series of
conditional statements?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The input variable name is <code>specification</code> this takes on
character values so we need to use the == statement.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>process ESTIMATION <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a> input<span class="op">:</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  tuple <span class="fu">val</span><span class="op">(</span>school_period<span class="op">),</span> <span class="fu">val</span><span class="op">(</span>specification<span class="op">),</span> <span class="fu">val</span><span class="op">(</span>school_ID_dat<span class="op">),</span> <span class="fu">path</span><span class="op">(</span>compositionFile_period<span class="op">),</span> <span class="fu">val</span><span class="op">(</span>school_ID<span class="op">),</span> <span class="fu">path</span><span class="op">(</span>STR<span class="op">),</span> <span class="fu">val</span><span class="op">(</span>period<span class="op">),</span> <span class="fu">val</span><span class="op">(</span>effects<span class="op">)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>script<span class="op">:</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>specification <span class="op">==</span> <span class="st">"all"</span><span class="op">)</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>      template <span class="st">'1000_model_estimation_all.R'</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>specification <span class="op">==</span> <span class="st">"influence"</span><span class="op">)</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>      template <span class="st">'1000_model_estimation_influence.R'</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>specification <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>      template <span class="st">'1000_model_estimation_no.R'</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>      template <span class="st">'1000_model_estimation_selection.R'</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="conditional-execution-of-a-process">Conditional execution of a process<a class="anchor" aria-label="anchor" href="#conditional-execution-of-a-process"></a>
</h2>
<hr class="half-width">
<p>The <code>when</code> declaration allows you to define a condition
that must be verified in order to execute the process. This can be any
expression that evaluates a boolean value; <code>true</code> or
<code>false</code>.</p>
<p>It is useful to enable/disable the process execution depending on the
state of various inputs and parameters.</p>
<div class="section level4">
<h4 id="directives">Directives<a class="anchor" aria-label="anchor" href="#directives"></a>
</h4>
<p>Directive declarations allow the definition of optional settings,
like the number of <code>cpus</code> and amount of <code>memory</code>,
that affect the execution of the current process without affecting the
task itself.</p>
<p>They must be entered at the top of the process body, before any other
declaration blocks (i.e.¬†<code>input</code>, <code>output</code>,
etc).</p>
<p><strong>Note:</strong> You do not use <code>=</code> when assigning a
value to a directive.</p>
<p>Directives are commonly used to define the amount of computing
resources to be used or extra information for configuration or logging
purpose.</p>
<div id="task-6.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-6.2" class="callout-inner">
<h3 class="callout-title">Task 6.2</h3>
<div class="callout-content">
<p>Inspect the module <code>ESTIMATION</code>, what is the name of the
variable used in the directive or tag of the process? Where is this
defined in the process?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The directive used to label and distinguish tasks for each run of the
<code>ESTIMATION</code> process is <code>school_period</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">//06_modules_optional.nf</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>process ESTIMATION <span class="op">{</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>     tag<span class="op">{</span>school_period<span class="op">}</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The above process uses the one directives, <code>tag</code>.</p>
<p>The <code>tag</code> directive to allow you to give a custom tag to
each process execution. This tag makes it easier to identify a
particular task (implemented instance of a process) in a log file or in
the execution report.</p>
<p>Another directive <code>cpus</code> allows you to define the number
of CPUs required for each task.</p>
<p>One other directive <code>echo true</code> prints the stdout to the
terminal.</p>
<p>We use the Nextflow <code>task.cpus</code> variable to capture the
number of cpus assigned to a task. This is frequently used to specify
the number of threads in a multi-threaded command in the script
block.</p>
<p>Another commonly used directive is memory specification:
<code>memory</code>.</p>
<p>A complete list of directives is available at this <a href="https://www.nextflow.io/docs/latest/process.html#directives" class="external-link">link</a>.</p>
<div id="task-6.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-6.3" class="callout-inner">
<h3 class="callout-title">Task 6.3</h3>
<div class="callout-content">
<p>Many software tools allow users to configure the number of CPU
threads used, optimizing performance for faster and more efficient data
processing in high-throughput tasks.</p>
<p>Open the <code>06_modules_optional.nf</code> script.</p>
<p>Based on the set of directives write a comment explaining what the
purpose of each one is.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">//06_modules_optional.nf</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>process ESTIMATION <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  tag<span class="op">{</span>school_period<span class="op">}</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  label <span class="st">'small_time_cpus'</span> <span class="co">// process label allocating resources </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  errorStrategy <span class="op">{</span> task<span class="op">.</span>exitStatus <span class="op">==</span> <span class="dv">140</span> <span class="op">?</span> <span class="st">'retry'</span> <span class="op">:</span> <span class="st">'ignore'</span> <span class="op">}</span> <span class="co">// if a task happens to fail, ask nextflow to carry on with the rest of the tasks, otherwise it'll stop all processes</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  maxRetries <span class="dv">1</span> <span class="co">// specify the number of times to a process is to be rescheduled once it fails</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="organising-outputs">Organising outputs<a class="anchor" aria-label="anchor" href="#organising-outputs"></a>
</h4>
<p><strong>PublishDir directive</strong></p>
<p>Nextflow manages intermediate results from the pipeline‚Äôs expected
outputs independently.</p>
<p>Files created by a <code>process</code> are stored in a task specific
working directory which is considered as temporary. Normally this is
under the <code>work</code> directory, which can be deleted upon
completion.</p>
<p>The files you want the workflow to return as results need to be
defined in the <code>output</code> block of the process and then the
output directory specified using the <code>directive</code>
<code>publishDir</code>. More information <a href="https://www.nextflow.io/docs/latest/process.html#publishdir" class="external-link">here</a>.</p>
<p><strong>Note:</strong> A common mistake is to specify an output
directory in the <code>publishDir</code> directive while forgetting to
specify the files you want to include in the <code>output</code>
block.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>publishDir <span class="op">&lt;</span>directory<span class="op">&gt;,</span> parameter<span class="op">:</span> value<span class="op">,</span> parameter2<span class="op">:</span> value <span class="op">...</span></span></code></pre>
</div>
<p>For example if we want to capture the results of the
<code>ESTIMATION</code> process in a
<code>results/siena_sim/$school_period</code> output directory we need
to define the files in the <code>output</code> and specify the location
of the results directory in the <code>publishDir</code> directive:</p>
<p>In the above example, the
<code>publishDir "results/siena_sim/$school_period"</code>, creates a
symbolic link <code>-&gt;</code> to the output files specified by the
process <code>ESTIMATION.simulation_ch</code> to the directory path
<code>results/siena_sim/$school_period</code>.</p>
<p>A symbolic link, often referred to as a symlink, is a type of file
that serves as a reference or pointer to another file or directory,
allowing multiple access paths to the same resource without duplicating
its actual data.</p>
<div id="publishdir" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="publishdir" class="callout-inner">
<h3 class="callout-title">publishDir</h3>
<div class="callout-content">
<p>The publishDir output is relative to the path the pipeline run has
been launched. Hence, it is a good practice to use <a href="https://www.nextflow.io/docs/latest/script.html?highlight=projectdir#script-implicit-variables" class="external-link">implicit
variables</a> like <code>projectDir</code> to specify publishDir
value.</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="publishdir-parameters">publishDir parameters<a class="anchor" aria-label="anchor" href="#publishdir-parameters"></a>
</h4>
<p>The <code>publishDir</code> directive can take optional parameters,
for example the <code>mode</code> parameter can take the value
<code>"copy"</code> to specify that you wish to copy the file to output
directory rather than just a symbolic link to the files in the working
directory. Since the working directory is generally deleted on
completion of a pipeline, it is safest to use <code>mode: "copy"</code>
for results files. The default mode (symlink) is helpful for checking
intermediate files which are not needed in the long term.</p>
<p>Full list <a href="https://www.nextflow.io/docs/latest/process.html#publishdir" class="external-link">here</a>.</p>
</div>
<div class="section level4">
<h4 id="manage-semantic-sub-directories">Manage semantic sub-directories<a class="anchor" aria-label="anchor" href="#manage-semantic-sub-directories"></a>
</h4>
<p>You can use more than one <code>publishDir</code> to keep different
outputs in separate directories. To specify which files to put in which
output directory use the parameter <code>pattern</code> with the a glob
pattern that selects which files to publish from the overall set of
output files.</p>
<p>In the example below we will create an output folder structure in the
directory results, which contains a separate sub-directory for sequence
id file, <code>pattern: "*.png"</code> , and a sequence directory,
<code>"$params.outdir/siena_gof/$school_period"</code> for the set of
goodness of fit figures assessing model fit. Remember, we need to
specify the files we want to copy as outputs.</p>
<div id="task-6.4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-6.4" class="callout-inner">
<h3 class="callout-title">Task 6.4</h3>
<div class="callout-content">
<p>Inspect the <code>publishDir</code> directive to the nextflow script
<code>06_modules_optional.nf</code> can you identify how many unique
output directories are specified by this single process ?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">//06_modules_optional.nf</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>process ESTIMATION <span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="fu">publishDir</span> <span class="st">"</span><span class="ss">$params</span><span class="op">.</span><span class="ss">outdir</span><span class="st">/siena_fit"</span><span class="op">,</span> pattern<span class="op">:</span> <span class="st">"*.RDS"</span><span class="op">,</span>  mode<span class="op">:</span> <span class="st">"copy"</span><span class="op">,</span> overwrite<span class="op">:</span> <span class="kw">true</span> <span class="co">// all file outputs are copied to this directory - i.e CONVERGED / NOT CONVERGED</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  publishDir <span class="st">"</span><span class="ss">$params</span><span class="op">.</span><span class="ss">outdir</span><span class="st">/siena_sim/</span><span class="ss">$school_period</span><span class="st">"</span><span class="op">,</span> pattern<span class="op">:</span> <span class="st">"*_SIM.RDS"</span><span class="op">,</span>  mode<span class="op">:</span> <span class="st">"copy"</span><span class="op">,</span> overwrite<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  publishDir <span class="st">"</span><span class="ss">$params</span><span class="op">.</span><span class="ss">outdir</span><span class="st">/siena_gof/</span><span class="ss">$school_period</span><span class="st">"</span><span class="op">,</span> pattern<span class="op">:</span> <span class="st">"*.png"</span><span class="op">,</span>  mode<span class="op">:</span> <span class="st">"copy"</span><span class="op">,</span> overwrite<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="op">}</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="nextflow-patterns" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="nextflow-patterns" class="callout-inner">
<h3 class="callout-title">Nextflow Patterns</h3>
<div class="callout-content">
<p>If you want to find out common structures of Nextflow processes, the
<a href="https://nextflow-io.github.io/patterns/" class="external-link">Nextflow Patterns
page</a> collects some recurrent implementation patterns used in
Nextflow applications.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Outputs to a process are defined using the output blocks.</li>
<li>You can group input and output data from a process using the tuple
qualifier.</li>
<li>The execution of a process can be controlled using the
<code>when</code> declaration and conditional statements.</li>
<li>Files produced within a process and defined as <code>output</code>
can be saved to a directory using the <code>publishDir</code>
directive.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-07"><p>Content from <a href="07.html">Workflow</a></p>
<hr>
<p>Last updated on 2025-06-28 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/07.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I connect channels and processes to create a workflow?</li>
<li>How do I invoke a process inside a workflow?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a Nextflow workflow joining multiple processes.</li>
<li>Understand how to to connect processes via their inputs and outputs
within a workflow.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<hr class="half-width">
<p>Our previous episodes have shown how to parameterise workflows using
<code>params</code>, move data around a workflow using
<code>channels</code> and define individual tasks using
<code>processes</code>. In this episode we will cover how connect
multiple processes to create a workflow.</p>
</section><section><h2 class="section-heading" id="workflow-definition">Workflow definition<a class="anchor" aria-label="anchor" href="#workflow-definition"></a>
</h2>
<hr class="half-width">
<p>We can connect processes to create our pipeline inside a
<code>workflow</code> scope. The workflow scope starts with the keyword
<code>workflow</code>, followed by an optional name and finally the
workflow body delimited by curly brackets <code>{}</code>.</p>
<div id="task-7.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-7.1" class="callout-inner">
<h3 class="callout-title">Task 7.1</h3>
<div class="callout-content">
<p>Ready set workflow! Run the full workflow demo.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">nextflow</span> run main.nf <span class="at">-profile</span> local</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
training/sgsss-workflow/scripts -&gt; nextflow run main.nf -profile local
Nextflow 25.04.4 is available - Please consider updating your version to it

 N E X T F L O W   ~  version 25.04.3

Launching `main.nf` [confident_kimura] DSL2 - revision: bc82a00e22


====================================================
 ‚ïî‚ïê‚ïî ‚ïî‚ïê‚ïó‚ïî‚ïó‚ïî ‚ïî‚ïê‚ïó
 ‚ïë ‚ïë ‚ïë‚ï£ ‚ïë‚ïë‚ïë ‚ïë‚ïê‚ïë
‚ïê‚ïù ‚ïù ‚ïö‚ïê‚ïù‚ïù‚ïö‚ïù ‚ïù ‚ïù
====================================================
batches                     : 1
model specification         : /workspaces/training/sgsss-workflow/scripts/params/meta.csv
school data                 : /workspaces/training/sgsss-workflow/scripts/data/each_period.tar.gz
school info                 : /workspaces/training/sgsss-workflow/scripts/params/school_info.json
composition data            : /workspaces/training/sgsss-workflow/scripts/data/composition_each_period.tar.gz
effects                     : /workspaces/training/sgsss-workflow/scripts/params/effects.csv
subgroup                    : /workspaces/training/sgsss-workflow/scripts/params/subgroup.csv



executor &gt;  local (8)
[d0/de71b6] GENERATE_DAT (1)               [100%] 1 of 1 ‚úî
[08/aff58c] GENERATE_RDS (1)               [100%] 1 of 1 ‚úî
[0e/2d5ac4] ESTIMATION (school123_period2) [ 12%] 4 of 32
[-        ] META_MORAN                     -
[-        ] JOINFILES                      -
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="implicit-workflow" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="implicit-workflow" class="callout-inner">
<h3 class="callout-title">Implicit workflow</h3>
<div class="callout-content">
<p>In contrast to processes, the workflow definition in Nextflow does
not require a name. In Nextflow, if you don‚Äôt give a name to a workflow,
it‚Äôs considered the main/implicit starting point of your workflow
program.</p>
<p>A named workflow is a <code>subworkflow</code> that can be invoked
from other workflows, subworkflows are not covered in this lesson, more
information can be found in the official documentation <a href="https://www.nextflow.io/docs/latest/workflow.html" class="external-link">here</a>.</p>
</div>
</div>
</div>
<div class="section level4">
<h4 id="invoking-processes-with-a-workflow">Invoking processes with a workflow<a class="anchor" aria-label="anchor" href="#invoking-processes-with-a-workflow"></a>
</h4>
<p>As seen previously, a <code>process</code> is invoked as a function
in the <code>workflow</code> scope, passing the expected input channels
as arguments as it if were.</p>
<p>To combine multiple processes invoke them in the order they would
appear in a workflow. When invoking a process with multiple inputs,
provide them in the same order in which they are declared in the
<code>input</code> block of the process.</p>
</div>
<div class="section level4">
<h4 id="process-outputs">Process outputs<a class="anchor" aria-label="anchor" href="#process-outputs"></a>
</h4>
<p>A process output can also be accessed directly using the
<code>out</code> attribute for the respective
<code>process object</code>. Remember this is what we did in the Hello
Nextflow episode when we specified
<code>GENERATE_READS.out.view()</code> in the workflow definition.</p>
<p>When a process defines two or more output channels, each of them can
be accessed using the list element operator e.g.¬†<code>out[0]</code>,
<code>out[1]</code>, or using named outputs.</p>
</div>
<div class="section level4">
<h4 id="process-named-output">Process named output<a class="anchor" aria-label="anchor" href="#process-named-output"></a>
</h4>
<p>It can be useful to name the output of a process, especially if there
are multiple outputs.</p>
<p>The process <code>output</code> definition allows the use of the
<code>emit:</code> option to define a named identifier that can be used
to reference the channel in the external scope.</p>
<div id="task-7.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-7.2" class="callout-inner">
<h3 class="callout-title">Task 7.2</h3>
<div class="callout-content">
<p>Inspect the code for the <code>ESTIMATION</code> module. Can you
identify the named output that is used in the workflow in the
<code>main.nf</code> file?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The named out channel involves <code>simulation_ch</code> after
implementing the ESTIMATION moderator.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">//main.nf </span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>workflow<span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    estimation_out <span class="op">=</span> <span class="fu">ESTIMATION</span><span class="op">(</span>estimation_channel<span class="op">)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    estimation_out<span class="op">.</span>simulation_ch</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="accessing-script-parameters">Accessing script parameters<a class="anchor" aria-label="anchor" href="#accessing-script-parameters"></a>
</h4>
<p>A workflow component can access any variable and parameter defined in
the outer scope.</p>
<p>In this example <code>pipe_meta</code> or <code>pipe_effects</code>,
are defined outside the workflow scope, but are accessed inside the
<code>workflow</code> scope.</p>
<div id="task-7.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-7.3" class="callout-inner">
<h3 class="callout-title">Task 7.3</h3>
<div class="callout-content">
<p>Open the <code>main.nf</code> file and identify at which stage of the
workflow is the output of the process <code>META_MORAN</code> being
connected to <code>JOINFILES</code> process in the workflow
definition.</p>
<p><strong>Note:</strong> You will need to use the <code>collect</code>
operator to gather the items in the simulation_ch to a single List item.
The reason for this is the <code>JOINFILES</code> module combines output
into a figure summarising model comparison statistics.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">//main.nf </span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="op">.</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    estimation_out<span class="op">.</span>simulation_ch\</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>        <span class="op">|</span> map <span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="dv">0</span><span class="op">].</span><span class="fu">split</span><span class="op">(</span><span class="st">'_|</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">]]}</span> \</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">combine</span><span class="op">(</span>mapped_params<span class="op">,</span> by<span class="op">:</span> <span class="dv">0</span><span class="op">)</span> \</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>        <span class="op">|</span> transpose \</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">groupTuple</span><span class="op">(</span>by<span class="op">:</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">],</span> sort<span class="op">:</span> <span class="kw">true</span><span class="op">)</span> \</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>        <span class="op">|</span> map <span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">3</span><span class="op">],</span> it<span class="op">[</span><span class="dv">5</span><span class="op">]]</span>  <span class="op">}</span> \</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>        <span class="op">|</span> META_MORAN \</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>        <span class="op">|</span> collect \</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>        <span class="op">|</span> JOINFILES \</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>        <span class="op">|</span> view</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="op">}</span>        </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To import the workflow code navigate to the following repository:</p>
<ul>
<li><a href="https://github.com/omiridoue/sgsss-workflow/tree/ready-set-workflow" class="external-link">ready-set-workflow</a></li>
</ul>
<p>Then download the code as a ZIP folder or preferably use the git
command to store a local copy:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> ready-set-workflow <span class="at">--single-branch</span> https://github.com/omiridoue/sgsss-workflow.git</span></code></pre>
</div>
<p>Note if you download the material as a ZIP folder this will rename
the folder to sgsss-workflow-ready-set-workflow you can always reinstate
the repository name to avoid running into any name clashes.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A Nextflow workflow is defined by invoking <code>processes</code>
inside the <code>workflow</code> scope.</li>
<li>A process is invoked like a function inside the
<code>workflow</code> scope passing any required input parameters as
arguments. e.g.¬†<code>ESTIMATION(estimation_channel)</code>.</li>
<li>Process outputs can be accessed using the <code>out</code> attribute
for the respective <code>process</code> object or assigning the output
to a Nextflow variable.</li>
<li>Multiple outputs from a single process can be accessed using the
list syntax <code>[]</code> and it‚Äôs index or by referencing the a named
process output .</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-08"><p>Content from <a href="08.html">Operators</a></p>
<hr>
<p>Last updated on 2025-07-05 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/08.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I perform operations, such as filtering, on channels?</li>
<li>What are the different kinds of operations I can perform on
channels?</li>
<li>How do I combine operations?</li>
<li>How can I use a CSV file to process data into a Channel?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand what Nextflow operators are.</li>
<li>Modify the contents/elements of a channel using operators.</li>
<li>Perform filtering and combining operations on a channel object.</li>
<li>Use the <code>splitCsv</code> operator to parse the contents of CSV
file into a channel .</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="operators">Operators<a class="anchor" aria-label="anchor" href="#operators"></a>
</h2>
<hr class="half-width">
<p>In the Channels episode we learnt how to create Nextflow channels to
enable us to pass data and values around our workflow. If we want to
modify the contents or behaviour of a channel, Nextflow provides methods
called <code>operators</code>. We have previously used the
<code>view</code> operator to view the contents of a channel. There are
many more operator methods that can be applied to Nextflow channels that
can be usefully separated into several groups:</p>
<ul>
<li>
<strong>Filtering</strong> operators: reduce the number of elements
in a channel.</li>
<li>
<strong>Transforming</strong> operators: transform the value/data in
a channel.</li>
<li>
<strong>Splitting</strong> operators: split items in a channel into
smaller chunks.</li>
<li>
<strong>Combining</strong> operators: join channels together.</li>
<li>
<strong>Maths</strong> operators: apply simple math functions on
channels.</li>
<li>
<strong>Other</strong>: such as the view operator.</li>
</ul>
<p>In this episode you will see examples, and get to use different types
of operators.</p>
<p><strong>Using Operators</strong></p>
<p>To use an operator, the syntax is the channel name, followed by a dot
<code>.</code> , followed by the operator name and brackets
<code>()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>channel_obj<span class="op">.&lt;</span>operator<span class="op">&gt;()</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="view">view<a class="anchor" aria-label="anchor" href="#view"></a>
</h4>
<p>The <code>view</code> operator prints the items emitted by a channel
to the console appending a <em>new line</em> character to each item in
the channel. We can also chain together the channel factory method
<code>.of</code> and the operator <code>.view()</code> using the dot
notation. <strong>Note:</strong> the <code>view()</code> operator
doesn‚Äôt change the contents of the channel object.</p>
<div id="task-8.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-8.1" class="callout-inner">
<h3 class="callout-title">Task 8.1</h3>
<div class="callout-content">
<p>To make code more readable we can split the operators over several
lines. The blank space between the operators is ignored and is solely
for readability.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">//08_operators.nf</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>school_info<span class="op">)</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitJson</span><span class="op">()</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_school_info <span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="closures">Closures<a class="anchor" aria-label="anchor" href="#closures"></a>
</h5>
<p>An optional <em>closure</em> <code>{}</code> parameter can be
specified to customise how items are printed.</p>
<p>Briefly, a closure is a block of code that can be passed as an
argument to a function. In this way you can define a chunk of code and
then pass it around as if it were a string or an integer. By default the
parameters for a closure are specified with the groovy keyword
<code>$it</code> (‚Äòit‚Äô is for ‚Äòitem‚Äô).</p>
<div id="task-8.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-8.2" class="callout-inner">
<h3 class="callout-title">Task 8.2</h3>
<div class="callout-content">
<p>For example here we apply a closure to the queue channel, to separate
the first two columns of the csv file as separate parameters and group
all remaining columns into a single list of parameters.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">//08_operators.nf</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>effects<span class="op">)</span>    </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitCsv</span><span class="op">(</span>header<span class="op">:</span> <span class="kw">false</span><span class="op">)</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span> <span class="op">{</span> row <span class="op">-&gt;</span> <span class="op">[</span>row<span class="op">[</span><span class="dv">0</span><span class="op">],</span> row<span class="op">[</span><span class="dv">1</span><span class="op">],</span> row<span class="op">[</span><span class="fl">2.</span><span class="op">.-</span><span class="dv">1</span><span class="op">]]</span> <span class="op">}</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_effects <span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="filtering-operators">Filtering operators<a class="anchor" aria-label="anchor" href="#filtering-operators"></a>
</h3>
<p>We can reduce the number of items in a channel by using filtering
operators.</p>
<p>The <code>filter</code> operator allows you to get only the items
emitted by a channel that satisfy a condition and discard all the
others. The filtering condition can be specified by using either:</p>
<ul>
<li>a regular expression</li>
<li>a literal value</li>
<li>a data type qualifier, e.g.¬†Number (any integer,float ‚Ä¶), String,
Boolean</li>
<li>or any boolean statement.</li>
</ul>
<div class="section level5">
<h5 id="data-type-qualifier">Data type qualifier<a class="anchor" aria-label="anchor" href="#data-type-qualifier"></a>
</h5>
<p>Here we use the <code>filter</code> operator specifying the data type
qualifier <code>Number</code> so that only numeric items are returned.
The Number data type includes both integers and floating point numbers.
We will then use the <code>view</code> operator to print the contents.
To simplify the code we can chain multiple operators together, such as
<code>filter</code> and <code>view</code> using a <code>.</code> .</p>
<p>The previous example could be rewritten like: The blank space between
the operators is ignored and is used for readability.</p>
</div>
<div class="section level5">
<h5 id="regular-expression">Regular expression<a class="anchor" aria-label="anchor" href="#regular-expression"></a>
</h5>
<p>We chain the <code>.split()</code> function, to extract the school ID
from the input file name.</p>
<div id="task-8.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-8.3" class="callout-inner">
<h3 class="callout-title">Task 8.3</h3>
<div class="callout-content">
<p>Based on the example code in the <code>08_operators.nf</code> file,
explain the purpose of the split operator and intended output. Use the
<code>nextflow run 08_operators.nf</code> to run the workflow and
inspect the processs output using the <code>.view()</code> operator.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Note we specify a regular expression <code>.split("_|\\.")</code>
within the function in order to split the string based on the underscore
‚Äú_‚Äù or punctuation ‚Äú.‚Äù (whichever comes first) to derive an input
variable, based on school ID. This is where generating file names
dynamically as part of the workflow becomes relevant, as file names can
be play an important role in managing the stream of data.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">//08_operators.nf</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    dataset <span class="op">=</span>  <span class="fu">GENERATE_DAT</span><span class="op">(</span>ZipChannel_RDS<span class="op">)</span> \</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="op">|</span> flatten \</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="op">|</span> map <span class="op">{</span> file <span class="op">-&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    <span class="dt">def</span> key <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">'</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="dt">def</span> school_ID <span class="op">=</span> file<span class="op">.</span>name<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"_|</span><span class="sc">\\</span><span class="st">."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">tuple</span><span class="op">(</span>school_ID<span class="op">,</span> key<span class="op">,</span> file<span class="op">)}</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="boolean-statement">Boolean statement<a class="anchor" aria-label="anchor" href="#boolean-statement"></a>
</h5>
<p>A filtering condition can be defined by using a Boolean expression
described by a closure <code>{}</code> and returning a boolean
value.</p>
</div>
<div class="section level5">
<h5 id="literal-value">Literal value<a class="anchor" aria-label="anchor" href="#literal-value"></a>
</h5>
<p>Finally, if we only want to include elements of a specific value we
can specify a literal value.</p>
</div>
</div>
<div class="section level3">
<h3 id="modifying-the-contents-of-a-channel">Modifying the contents of a channel<a class="anchor" aria-label="anchor" href="#modifying-the-contents-of-a-channel"></a>
</h3>
<p>If we want to modify the items in a channel, we can use transforming
operators.</p>
<div class="section level4">
<h4 id="map">map<a class="anchor" aria-label="anchor" href="#map"></a>
</h4>
</div>
<div class="section level4">
<h4 id="applying-a-function-to-items-in-a-channel">Applying a function to items in a channel<a class="anchor" aria-label="anchor" href="#applying-a-function-to-items-in-a-channel"></a>
</h4>
<p>The <code>map</code> operator applies a function of your choosing to
every item in a channel, and returns the items so obtained as a new
channel. The function applied is called the mapping function and is
expressed with a closure <code>{}</code>.</p>
<p>We can also use the <code>map</code> operator to transform each
element into a tuple.</p>
<p>In the example below we use the <code>map</code> operator to
transform a channel.</p>
<p>We can change the default name of the closure parameter keyword from
<code>it</code> to a more meaningful name <code>file</code> using
<code>-&gt;</code>. When we have multiple parameters we can specify the
keywords at the start of the closure,
e.g.¬†<code>file, key -&gt;</code>.</p>
<div id="task-8.4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-8.4" class="callout-inner">
<h3 class="callout-title">Task 8.4</h3>
<div class="callout-content">
<p>Inspect the code in the file <code>08_operators.nf</code> explain the
purpose of the <code>map</code> operator on the
<code>estimation_out.simulation_ch</code>. How is it used to transform
the contents into a tuple with the file and the file‚Äôs name? Write
additional comments within the script. (Hint: Use the <code>view</code>
operator to inspect the channel contents.)</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>The simulation_ch output emits a tuple of elements as part of the
simulation output from the <code>ESTIMATION</code> process. The map
operator transforms the first of the elements indexed by
<code>[0]</code> and uses a regular expression to split the character
value on the first <code>_</code> it encounters. Ex. it takes
<code>school123_period1</code> and returns <code>school123</code>, this
allows us to generate a school identifier.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">//08_operators.nf</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    estimation_out<span class="op">.</span>simulation_ch\</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>        <span class="op">|</span> map <span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="dv">0</span><span class="op">].</span><span class="fu">split</span><span class="op">(</span><span class="st">'_|</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">]]}</span> </span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="op">.</span>   </span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="converting-a-list-into-multiple-items">Converting a list into multiple items<a class="anchor" aria-label="anchor" href="#converting-a-list-into-multiple-items"></a>
</h4>
<p>The <code>flatten</code> operator transforms a channel in such a way
that every item in a <code>list</code> or <code>tuple</code> is
flattened so that each single entry is emitted as a sole element by the
resulting channel.</p>
<p>This is similar to the channel factory
<code>Channel.fromList</code>.</p>
</div>
<div class="section level4">
<h4 id="converting-the-contents-of-a-channel-to-a-single-list-item-">Converting the contents of a channel to a single list item.<a class="anchor" aria-label="anchor" href="#converting-the-contents-of-a-channel-to-a-single-list-item-"></a>
</h4>
<p>The reverse of the <code>flatten</code> operator is
<code>collect</code>. The <code>collect</code> operator collects all the
items emitted by a channel to a list and return the resulting object as
a sole emission. This can be extremely useful when combining the results
from the output of multiple processes, or a single process run multiple
times.</p>
<p>The result of the collect operator is a <code>value</code> channel
and can be used multiple times.</p>
</div>
<div class="section level4">
<h4 id="grouping-contents-of-a-channel-by-a-key-">Grouping contents of a channel by a key.<a class="anchor" aria-label="anchor" href="#grouping-contents-of-a-channel-by-a-key-"></a>
</h4>
<p>The <code>groupTuple</code> operator collects <code>tuples</code> or
<code>lists</code> of values by grouping together the channel elements
that share the same key. Finally it emits a new tuple object for each
distinct key collected.</p>
<p>If we know the number of items to be grouped we can use the
<code>groupTuple</code> and <code>size</code> parameter. When the
specified size is reached, the tuple is emitted. By default incomplete
tuples (i.e.¬†with less than size grouped items) are discarded
(default).</p>
<p>This operator is useful to process altogether all elements for which
there‚Äôs a common property or a grouping key.</p>
<div id="task-8.5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-8.5" class="callout-inner">
<h3 class="callout-title">Task 8.5</h3>
<div class="callout-content">
<p>Inspect the code in the file <code>08_operators.nf</code> explain the
purpose of the <code>groupTuple</code> operator. How is it used to
transform the contents into a tuple ? Write additional comments within
the script. (Hint: Use the <code>view</code> operator to inspect the
channel contents.)</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">//08_operators.nf</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    estimation_out<span class="op">.</span>simulation_ch\</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>        <span class="op">|</span> map <span class="op">{</span> it <span class="op">-&gt;</span> <span class="op">[</span>it<span class="op">[</span><span class="dv">0</span><span class="op">].</span><span class="fu">split</span><span class="op">(</span><span class="st">'_|</span><span class="sc">\\</span><span class="st">.'</span><span class="op">)[</span><span class="dv">0</span><span class="op">],</span> it<span class="op">[</span><span class="dv">1</span><span class="op">],</span> it<span class="op">[</span><span class="dv">2</span><span class="op">],</span> it<span class="op">[</span><span class="dv">3</span><span class="op">],</span> it<span class="op">[</span><span class="dv">4</span><span class="op">]]}</span> \</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">combine</span><span class="op">(</span>mapped_params<span class="op">,</span> by<span class="op">:</span> <span class="dv">0</span><span class="op">)</span> \</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>        <span class="op">|</span> transpose \</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">groupTuple</span><span class="op">(</span>by<span class="op">:</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">],</span> sort<span class="op">:</span> <span class="kw">true</span><span class="op">)</span> </span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="op">.</span>   </span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="merging-channels">Merging Channels<a class="anchor" aria-label="anchor" href="#merging-channels"></a>
</h3>
<p>Combining operators allows you to merge channels together. This can
be useful when you want to combine the output channels from multiple
processes.</p>
<div class="section level4">
<h4 id="mix">mix<a class="anchor" aria-label="anchor" href="#mix"></a>
</h4>
<p>The <code>mix</code> operator combines the items emitted by two (or
more) channels into a single channel.</p>
<p>The items emitted by the resulting mixed channel may appear in any
order, regardless of which source channel they came from. Thus, the
following example it could be a possible result of the above example as
well.</p>
</div>
<div class="section level4">
<h4 id="join">join<a class="anchor" aria-label="anchor" href="#join"></a>
</h4>
<p>The <code>join</code> operator creates a channel that joins together
the items emitted by two channels for which exists a matching key. The
key is defined, by default, as the first element in each item
emitted.</p>
</div>
</div>
<div class="section level3">
<h3 id="maths-operators">Maths operators<a class="anchor" aria-label="anchor" href="#maths-operators"></a>
</h3>
<p>The maths operators allows you to apply simple math function on
channels.</p>
<p>The maths operators are:</p>
<ul>
<li>count</li>
<li>min</li>
<li>max</li>
<li>sum</li>
<li>toInteger</li>
</ul>
<div class="section level4">
<h4 id="counting-items-in-a-channel">Counting items in a channel<a class="anchor" aria-label="anchor" href="#counting-items-in-a-channel"></a>
</h4>
<p>The <code>count</code> operator creates a channel that emits a single
item: a number that represents the total number of items emitted by the
source channel. For example:</p>
</div>
</div>
<div class="section level3">
<h3 id="splitting-items-in-a-channel">Splitting items in a channel<a class="anchor" aria-label="anchor" href="#splitting-items-in-a-channel"></a>
</h3>
<p>Sometimes you want to split the content of a individual item in a
channel, like a file or string, into smaller chunks that can be
processed by downstream operators or processes e.g.¬†items stored in a
CSV file.</p>
<p>Nextflow has a number of splitting operators that can achieve
this:</p>
<ul>
<li>
<a href="https://www.nextflow.io/docs/latest/operator.html#splitcsv" class="external-link">splitCsv</a>:
The splitCsv operator allows you to parse text items emitted by a
channel, that are formatted using the CSV format, and split them into
records or group them into list of records with a specified length.</li>
<li>
<a href="https://www.nextflow.io/docs/latest/operator.html#splittext" class="external-link">splitText</a>:
The splitText operator allows you to split multi-line strings or text
file items, emitted by a source channel into chunks containing n lines,
which will be emitted by the resulting channel.</li>
</ul>
<div class="section level4">
<h4 id="splitcsv">splitCsv<a class="anchor" aria-label="anchor" href="#splitcsv"></a>
</h4>
<p>The <code>splitCsv</code> operator allows you to parse text items
emitted by a channel, that are formatted using the CSV format, and split
them into records or group them into list of records with a specified
length. This is useful when you want to use a sample sheet.</p>
<p>In the simplest case just apply the <code>splitCsv</code> operator to
a channel emitting a CSV formatted text files or text entries. For
example:</p>
<p>For the CSV file <code>effects.csv</code>.</p>
<p>We can use the <code>splitCsv()</code> operator to split the channel
contaning a CSV file into three elements.</p>
<p>The above example shows hows the CSV file <code>effects.csv</code> is
parsed and is split into three elements.</p>
<div class="section level5">
<h5 id="accessing-values">Accessing values<a class="anchor" aria-label="anchor" href="#accessing-values"></a>
</h5>
<p>Values can be accessed by their positional indexes using the square
brackets syntax<code>[index]</code>. So to access the first column you
would use <code>[0]</code> as shown in the following example:</p>
</div>
<div class="section level5">
<h5 id="column-headers">Column headers<a class="anchor" aria-label="anchor" href="#column-headers"></a>
</h5>
<p>When the CSV begins with a header line defining the column names, you
can specify the parameter <code>header: true</code> which allows you to
reference each value by its name, as shown in the following example:</p>
<div id="task-8.6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-8.6" class="callout-inner">
<h3 class="callout-title">Task 8.6</h3>
<div class="callout-content">
<p>Inspect the <code>08_operators.nf</code>, how is the
<code>params/effects.csv</code> being parsed?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>Each row of the csv is read as a separate input. The closure using
the map operator organises inputs by indexing the column order. The
first two columns are stored as separate elements while the remaining
columns are grouped into a list. The resulting input comprises of a
tuple that involves 3 elements, two values and one list.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">//08_operators.nf</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="bu">Channel</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span>params<span class="op">.</span>effects<span class="op">)</span>    </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="op">.</span><span class="fu">splitCsv</span><span class="op">(</span>header<span class="op">:</span> <span class="kw">false</span><span class="op">)</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span> <span class="op">{</span> row <span class="op">-&gt;</span> <span class="op">[</span>row<span class="op">[</span><span class="dv">0</span><span class="op">],</span> row<span class="op">[</span><span class="dv">1</span><span class="op">],</span> row<span class="op">[</span><span class="fl">2.</span><span class="op">.-</span><span class="dv">1</span><span class="op">]]</span> <span class="op">}</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span><span class="op">{</span> pipe_effects <span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="tab-delimited-files">Tab delimited files<a class="anchor" aria-label="anchor" href="#tab-delimited-files"></a>
</h4>
<p>If you want to split a <code>tab</code> delimited file or file
separated by another character use the <code>sep</code> parameter of the
split <code>splitCsv</code> operator.</p>
</div>
</div>
<div class="section level3">
<h3 id="more-resources">More resources<a class="anchor" aria-label="anchor" href="#more-resources"></a>
</h3>
<p>See the operators <a href="https://www.nextflow.io/docs/latest/operator.html" class="external-link">documentation</a>
on the Nextflow web site.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Nextflow <em>operators</em> are methods that allow you to modify,
set or view channels.</li>
<li>Operators can be separated in to several groups; filtering ,
transforming , splitting , combining , forking and Maths operators.</li>
<li>To use an operator use the dot notation after the Channel object
e.g.¬†<code>ESTIMATION.simulation_ch.view()</code>.</li>
<li>You can parse text items emitted by a channel, that are formatted
using the CSV format, using the <code>splitCsv</code> operator.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-09"><p>Content from <a href="09.html">Reporting</a></p>
<hr>
<p>Last updated on 2025-06-27 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/09.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I get information about my pipeline run?</li>
<li>How can I see what commands I ran?</li>
<li>How can I create a report from my run?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>View Nextflow pipeline run logs.</li>
<li>Use <code>nextflow log</code> to view more information about a
specific run.</li>
<li>Create an HTML report from a pipeline run.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="nextflow-log">Nextflow log<a class="anchor" aria-label="anchor" href="#nextflow-log"></a>
</h2>
<hr class="half-width">
<p>Once a script has run, Nextflow stores a log of all the workflows
executed in the current folder. Similar to an electronic lab book, this
means you have a record of all processing steps and commands run.</p>
<p>You can print Nextflow‚Äôs execution history and log information using
the <code>nextflow log</code> command.</p>
<p>This will print a summary of the executions log and runtime
information for all pipelines run. By default, included in the summary,
are the date and time it ran, how long it ran for, the run name, run
status, a revision ID, the session id and the command run on the command
line.</p>
<div id="task-9.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-9.1" class="callout-inner">
<h3 class="callout-title">Task 9.1</h3>
<div class="callout-content">
<p>Listing the execution logs of previous invocations of all pipelines
in a directory.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> nextflow log</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The output will look similar to this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>TIMESTAMP               DURATION        RUN NAME                STATUS  REVISION ID     SESSION ID                        COMMAND
2025-04-12 17:56:01     3.2s            disturbed_bartik        OK      8a3d1bb9c7      09de2950-9894-4463-b55b-4afa4268a3e2    nextflow run read_data.nf </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>If we want to get more information about a timeline we can request a
timeline or report to be outputted to the <code>docs/</code> folder in
our repository.</p>
<div id="task-9.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-9.2" class="callout-inner">
<h3 class="callout-title">Task 9.2</h3>
<div class="callout-content">
<p>Output a report.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>report <span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="co">// there is some isse with ps not being available in the container So I wanted to ask if you see the possibility to include ps in your docker container so that it can be used with nextflow (had only a problem with missing ps, but all others seem available, i.e. awk, date, grep, egrep, sed, tail, tee).</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  enabled <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  overwrite <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  file <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>projectDir<span class="ss">}</span><span class="st">/docs/report.html"</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This will list the set of tasks and the time and memory resources
these required to be completed. Additionally, further information is
included on the command used to launch the pipeline, the output
directory, and the status of each job submission, i.e whether this was
Cached (run previously), Succeeded or Failed.</p>
<p>Information is included on the timeline of tasks scheduled as part of
the pipeline.</p>
<div id="task-9.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-9.3" class="callout-inner">
<h3 class="callout-title">Task 9.3</h3>
<div class="callout-content">
<p>Output a timeline.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>timeline <span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  enabled <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  overwrite <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  file <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>projectDir<span class="ss">}</span><span class="st">/docs/timeline.html"</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Nextflow can produce a custom execution report with run information
using the <code>log</code> command.</li>
<li>You can generate a report or timeline using the template specified
by Nextflow.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-10"><p>Content from <a href="10.html">Nextflow configuration</a></p>
<hr>
<p>Last updated on 2025-06-27 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/10.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I configure a Nextflow workflow?</li>
<li>How do I assign different resources to different processes?</li>
<li>How do I separate and provide configuration for different
computational systems?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a Nextflow configuration file.</li>
<li>Be able to assign resources to a process.</li>
<li>Be able to inspect configuration settings before running a
workflow.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="nextflow-configuration">Nextflow configuration<a class="anchor" aria-label="anchor" href="#nextflow-configuration"></a>
</h2>
<hr class="half-width">
<p>A key Nextflow feature is the ability to decouple the workflow
implementation, which describes the flow of data and operations to
perform on that data, from the configuration settings required by the
underlying execution platform. This enables the workflow to be portable,
allowing it to run on different computational platforms such as an
institutional HPC or cloud infrastructure, without needing to modify the
workflow implementation.</p>
<p>We have seen earlier that it is possible to provide a
<code>process</code> with directives. These directives are process
specific configuration settings. Similarly, we have also provided
parameters to our workflow which are parameter configuration settings.
These configuration settings can be separated from the workflow
implementation, into a configuration file.</p>
<p>Settings in a configuration file are sets of name-value pairs
(<code>name = value</code>). The <code>name</code> is a specific
property to set, while the <code>value</code> can be anything you can
assign to a variable (for ex. strings, booleans, or other variables). It
is also possible to access any variable defined in the host environment
such as <code>$PATH</code>, <code>$HOME</code>, <code>$PWD</code>,
etc.</p>
<div id="configuration-file" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="configuration-file" class="callout-inner">
<h3 class="callout-title">Configuration file</h3>
<div class="callout-content">
<p>Generally, variables and functions defined in a configuration file
are not accessible from the workflow script. Only variables defined
using the <code>params</code> scope and the <code>env</code> scope
(without <code>env</code> prefix) can be accessed from the workflow
script.</p>
</div>
</div>
</div>
<p>Settings are also partitioned into scopes, which govern the behaviour
of different elements of the workflow. For example, workflow parameters
are governed from the <code>params</code> scope, while process
directives are governed from the <code>process</code> scope. A full list
of the available scopes can be found in the <a href="https://www.nextflow.io/docs/latest/config.html#config-scopes" class="external-link">documentation</a>.
It is also possible to define your own scope.</p>
<div id="task-10.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-10.1" class="callout-inner">
<h3 class="callout-title">Task 10.1</h3>
<div class="callout-content">
<p>Configuration settings for a workflow are often stored in the file
<code>nextflow.config</code> which is in the same directory as the
workflow script. Configuration can be written in either of two ways. The
first is using dot notation, and the second is using brace notation.
Both forms of notation can be used in the same configuration file.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>An example of dot notation:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>params<span class="op">.</span>outdir <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/results"</span>   <span class="co">// The workflow parameter "outdir" is assigned the value base output directory and './results' subfolder to use by default.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>params<span class="op">.</span>meta <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/meta.csv"</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>params<span class="op">.</span>effects <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/effects.csv"</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>params<span class="op">.</span>subgroup <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/subgroup.csv"</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>params<span class="op">.</span>school_data <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/data/each_period.tar.gz"</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>params<span class="op">.</span>school_info <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/school_info.json"</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>params<span class="op">.</span>composition_data <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/data/composition_each_period.tar.gz"</span></span></code></pre>
</div>
<p>An example of brace notation:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>params <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>                outdir <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/results"</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                batches <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                meta <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/meta.csv"</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                effects <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/effects.csv"</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>                subgroup <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/subgroup.csv"</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                school_data <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/data/each_period.tar.gz"</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>                school_info <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/params/school_info.json"</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                composition_data <span class="op">=</span> <span class="st">"</span><span class="ss">${</span>baseDir<span class="ss">}</span><span class="st">/data/composition_each_period.tar.gz"</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
<p>Configuration files can also be separated into multiple files and
included into another using the
<code>includeConfig "params.config"</code> statement.</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="how-configuration-files-are-combined">How configuration files are combined<a class="anchor" aria-label="anchor" href="#how-configuration-files-are-combined"></a>
</h4>
<p>Configuration settings can be spread across several files. This also
allows settings to be overridden by other configuration files. The
priority of a setting is determined by the following order, ranked from
highest to lowest.</p>
<ol style="list-style-type: decimal">
<li>Parameters specified on the command line
(<code>--param_name value</code>).</li>
<li>Parameters provided using the <code>-params-file</code> option.</li>
<li>Config file specified using the <code>-c</code> my_config
option.</li>
<li>The config file named <code>nextflow.config</code> in the current
directory.</li>
<li>The config file named <code>nextflow.config</code> in the workflow
project directory (<code>$projectDir</code>: the directory where the
script to be run is located).</li>
<li>The config file <code>$HOME/.nextflow/config</code>.</li>
<li>Values defined within the workflow script itself (e.g.,
<code>main.nf</code>).</li>
</ol>
<p>If configuration is provided by more than one of these methods,
configuration is merged giving higher priority to configuration provided
higher in the list.</p>
<div id="configuring-nextflow-vs-configuring-a-nextflow-workflow" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="configuring-nextflow-vs-configuring-a-nextflow-workflow" class="callout-inner">
<h3 class="callout-title">Configuring Nextflow vs Configuring a Nextflow workflow</h3>
<div class="callout-content">
<p>The majority of Nextflow configuration settings must be provided on
the command-line, however a handful of settings can also be provided
within a configuration file, such as
<code>workdir = '/path/to/work/dir'</code>
(<code>-w /path/to/work/dir</code>) or <code>resume = true</code>
(<code>-resume</code>), and do not belong to a configuration scope.</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="configuring-process-behaviour">Configuring process behaviour<a class="anchor" aria-label="anchor" href="#configuring-process-behaviour"></a>
</h4>
<p>Earlier we saw that <code>process</code> directives allow the
specification of settings for the task execution such as
<code>cpus</code>, <code>memory</code>, <code>conda</code> and other
resources in the pipeline script. This is useful when prototyping a
small workflow script, however this ties the configuration to the
workflow, making it less portable. A good practice is to separate the
process configuration settings into another file.</p>
<p>The <code>process</code> configuration scope allows the setting of
any process directives in the <code>conf/</code> directory.</p>
<div id="task-10.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-10.2" class="callout-inner">
<h3 class="callout-title">Task 10.2</h3>
<div class="callout-content">
<p>Navigate to the <code>conf</code> folder and open the local.config
file. What qualifier is being used to allocate resources to the process,
and how many resources does this involve?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>process <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>	withLabel<span class="op">:</span> small_time_cpus <span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>		executor <span class="op">=</span> <span class="st">'local'</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    	cache<span class="op">=</span><span class="st">'lenient'</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>		cpus <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>	<span class="op">}</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="unit-values" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="unit-values" class="callout-inner">
<h3 class="callout-title">Unit values</h3>
<div class="callout-content">
<p>Memory and time duration units can be specified either using a string
based notation in which the digit(s) and the unit can be separated by a
space character, or by using the numeric notation in which the digit(s)
and the unit are separated by a dot character and not enclosed by quote
characters.</p>
<table class="table">
<thead><tr class="header">
<th>String syntax</th>
<th>Numeric syntax</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>‚Äò10 KB‚Äô</td>
<td>10.KB</td>
<td>10240 bytes</td>
</tr>
<tr class="even">
<td>‚Äò500 MB‚Äô</td>
<td>500.MB</td>
<td>524288000 bytes</td>
</tr>
<tr class="odd">
<td>‚Äò1 min‚Äô</td>
<td>1.min</td>
<td>60 seconds</td>
</tr>
<tr class="even">
<td>‚Äò1 hour 25 sec‚Äô</td>
<td>-</td>
<td>1 hour and 25 seconds</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These settings are applied to all processes in the workflow. A
process selector can be used to apply the configuration to a specific
process or group of processes.</p>
</div>
<div class="section level4">
<h4 id="process-selectors">Process selectors<a class="anchor" aria-label="anchor" href="#process-selectors"></a>
</h4>
<p>When a workflow has many processes, it is inconvenient to specify
directives for all processes individually, especially if directives are
repeated for groups of processes. A helpful strategy is to annotate the
processes using the <code>label</code> directive (processes can have
multiple labels). The <code>withLabel</code> selector then allows the
configuration of all processes annotated with a specific label, as shown
below:</p>
<p>Another strategy is to use process selector expressions. Both
<code>withName:</code> and <code>withLabel:</code> allow the use of
regular expressions to apply the same configuration to all processes
matching a pattern. Regular expressions must be quoted, unlike simple
process names or labels.</p>
<ul>
<li>The <code>|</code> matches either-or, e.g.,
<code>withName: 'small_time_cpus|big_mem'</code> applies the
configuration to any process matching the name
<code>small_time_cpus</code> or <code>big_mem</code>.</li>
<li>The <code>!</code> inverts a selector, e.g.,
<code>withLabel: '!big_mem'</code> applies the configuration to any
process without the <code>big_mem</code> label.</li>
<li>The <code>.*</code> matches any number of characters, e.g.,
<code>withName: 'small_time_cpus:big_mem:.*'</code> matches all
processes of the workflow <code>small_time_cpus:big_mem</code>.</li>
</ul>
<p>A regular expression cheat-sheet can be found <a href="https://www.jrebel.com/system/files/regular-expressions-cheat-sheet.pdf" class="external-link">here</a>
if you would like to write more expressive expressions.</p>
</div>
<div class="section level4">
<h4 id="selector-priority">Selector priority<a class="anchor" aria-label="anchor" href="#selector-priority"></a>
</h4>
<p>When mixing generic process configuration and selectors, the
following priority rules are applied (from highest to lowest):</p>
<ol style="list-style-type: decimal">
<li>
<code>withName</code> selector definition.</li>
<li>
<code>withLabel</code> selector definition.</li>
<li>Process specific directive defined in the workflow script.</li>
<li>Process generic <code>process</code> configuration.</li>
</ol>
</div>
<div class="section level4">
<h4 id="dynamic-expressions">Dynamic expressions<a class="anchor" aria-label="anchor" href="#dynamic-expressions"></a>
</h4>
<p>A common scenario is that configuration settings may depend on the
data being processed. Such settings can be dynamically expressed using a
closure.</p>
<div id="task-10.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-10.3" class="callout-inner">
<h3 class="callout-title">Task 10.3</h3>
<div class="callout-content">
<p>For example, we can specify the <code>memory</code> required as a
multiple of the number of <code>cpus</code>. Similarly, we can publish
results to a subfolder based on the sample name.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>process ESTIMATION <span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  tag<span class="op">{</span>school_period<span class="op">}</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  label <span class="st">'small_time_cpus'</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  errorStrategy <span class="op">{</span> task<span class="op">.</span>exitStatus <span class="op">==</span> <span class="dv">140</span> <span class="op">?</span> <span class="st">'retry'</span> <span class="op">:</span> <span class="st">'ignore'</span> <span class="op">}</span> </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  maxRetries <span class="dv">1</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="op">.</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>process <span class="op">{</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    withLabel<span class="op">:</span> small_time_cpus <span class="op">{</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>    executor <span class="op">=</span> <span class="st">'slurm'</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    time   <span class="op">=</span> <span class="op">{</span> <span class="fl">2.</span>h   <span class="op">*</span> task<span class="op">.</span>attempt <span class="op">}</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>    clusterOptions <span class="op">=</span> <span class="st">"--account=none --mem=20G --partition=nodes --nodes=1 --cpus-per-task=10"</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>    <span class="op">.</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="configuring-execution-platforms">Configuring execution platforms<a class="anchor" aria-label="anchor" href="#configuring-execution-platforms"></a>
</h4>
<p>Nextflow supports a wide range of execution platforms, from running
locally, to running on HPC clusters or cloud infrastructures. See <a href="https://www.nextflow.io/docs/latest/executor.html" class="external-link">https://www.nextflow.io/docs/latest/executor.html</a>
for the full list of supported executors.</p>
<div id="task-10.4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-10.4" class="callout-inner">
<h3 class="callout-title">Task 10.4</h3>
<div class="callout-content">
<p>The <code>process.executor</code> directive allows you to override
the executor to be used by a specific process. This can be useful, for
example, when there are short running tasks that can be run locally, and
are unsuitable for submission to HPC executors (check for guidelines on
best practice use of your execution system). Other process directives
such as <code>process.clusterOptions</code>, <code>process.queue</code>,
and <code>process.machineType</code> can be also be used to further
configure processes depending on the executor used.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">//conf/slurm.config</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>process <span class="op">{</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    withLabel<span class="op">:</span> big_mem <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    executor <span class="op">=</span> <span class="st">'slurm'</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    clusterOptions <span class="op">=</span> <span class="st">"--account=none --time=15:00 --mem=7G --partition=nodes --nodes=1 --ntasks-per-node=1 --cpus-per-task=1 "</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    withLabel<span class="op">:</span> small_time_cpus <span class="op">{</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    executor <span class="op">=</span> <span class="st">'slurm'</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    time   <span class="op">=</span> <span class="op">{</span> <span class="fl">2.</span>h   <span class="op">*</span> task<span class="op">.</span>attempt <span class="op">}</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    clusterOptions <span class="op">=</span> <span class="st">"--account=none --mem=20G --partition=nodes --nodes=1 --cpus-per-task=10"</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    withLabel<span class="op">:</span> big_time_cpus <span class="op">{</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    executor <span class="op">=</span> <span class="st">'slurm'</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    clusterOptions <span class="op">=</span> <span class="st">"--account=none --time=10:00 --mem=1G --partition=nodes --nodes=1 --cpus-per-task=10"</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="configuring-software-requirements">Configuring software requirements<a class="anchor" aria-label="anchor" href="#configuring-software-requirements"></a>
</h4>
<p>Docker is a container technology. Container images are lightweight,
standalone, executable package of software that includes everything
needed to run an application: code, runtime, system tools, system
libraries and settings. Containerized software is intended to run the
same regardless of the underlying infrastructure, unlike other package
management technologies which are operating system dependant (See the <a href="https://doi.org/10.1038/nbt.3820" class="external-link">published article on
Nextflow</a>). For each container image used, Nextflow uses Docker to
spawn an independent and isolated container instance for each process
task.</p>
<p>To use Docker, we must provide a container image path using the
<code>process.container</code> directive, and also enable docker in the
docker scope, <code>docker.enabled = true</code>. A container image path
takes the form
<code>(protocol://)registry/repository/image:version--build</code>. By
default, Docker containers run software using a privileged user. This is
where Apptainer is preferred for computer cluster.</p>
</div>
<div class="section level4">
<h4 id="software-configuration-using-apptainer-former-singularity">Software configuration using Apptainer (former Singularity)<a class="anchor" aria-label="anchor" href="#software-configuration-using-apptainer-former-singularity"></a>
</h4>
<p>Singularity is another container technology, commonly used on HPC
clusters. It is different to Docker in several ways. The primary
differences are that processes are run as the user, and certain
directories are automatically ‚Äúmounted‚Äù (made available) in the
container instance. Singularity also supports building Singularity
images from Docker images, allowing Docker image paths to be used as
values for <code>process.container</code>.</p>
<p>Singularity is enabled in a similar manner to Docker. A container
image path must be provided using <code>process.container</code> and
singularity enabled using <code>apptainer.enabled = true</code>.</p>
<p>See episode 12 for more information on Auxiliary tools.</p>
<div id="container-protocols" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="container-protocols" class="callout-inner">
<h3 class="callout-title">Container protocols</h3>
<div class="callout-content">
<p>The following protocols are supported:</p>
<ul>
<li>
<code>docker://</code>: download the container image from the Docker
Hub and convert it to the Singularity format (default).</li>
<li>
<code>library://</code>: download the container image from the
Singularity Library service.</li>
<li>
<code>shub://</code>: download the container image from the
Singularity Hub.</li>
<li>
<code>https://</code>: download the singularity image from the given
URL.</li>
<li>
<code>file://</code>: use a singularity image on local computer
storage.</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="configuration-profiles">Configuration profiles<a class="anchor" aria-label="anchor" href="#configuration-profiles"></a>
</h2>
<hr class="half-width">
<p>One of the most powerful features of Nextflow configuration is to
predefine multiple configurations or <code>profiles</code> for different
execution platforms. This allows a group of predefined settings to be
called with a short invocation,
<code>-profile &lt;profile name&gt;</code>.</p>
<div id="task-10.5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-10.5" class="callout-inner">
<h3 class="callout-title">Task 10.5</h3>
<div class="callout-content">
<p>Configuration profiles are defined in the <code>profiles</code>
scope, which group the attributes that belong to the same profile using
a common prefix.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">//nextflow.config</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>profiles <span class="op">{</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  local <span class="op">{</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    includeConfig <span class="st">'conf/local.config'</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    docker<span class="op">.</span>enabled <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    process<span class="op">.</span>container <span class="op">=</span> <span class="st">'omiridoue/siena_r:0.8'</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  slurm <span class="op">{</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    includeConfig <span class="st">'conf/slurm.config'</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    apptainer<span class="op">.</span>enabled <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    apptainer<span class="op">.</span>cacheDir <span class="op">=</span> <span class="st">"apptainer"</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>    apptainer<span class="op">.</span>autoMounts <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    process<span class="op">.</span>executor <span class="op">=</span> <span class="st">'slurm'</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>    process<span class="op">.</span>container <span class="op">=</span> <span class="st">'omiridoue/siena_r:0.8'</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This configuration defines three different profiles:
<code>local</code>, and <code>slurm</code> that set different process
configuration strategies depending on the target execution platform. By
convention the standard profile is implicitly used when no other profile
is specified by the user. To enable a specific profile use
<code>-profile</code> option followed by the profile name:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">nextflow</span> run <span class="op">&lt;</span>your script<span class="op">&gt;</span> -profile local</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Nextflow configuration can be managed using a Nextflow configuration
file.</li>
<li>Nextflow configuration files are plain text files containing a set
of properties.</li>
<li>You can define process specific settings, such as cpus and memory,
within the <code>process</code> scope.</li>
<li>You can assign different resources to different processes using the
process selectors <code>withName</code> or <code>withLabel</code>.</li>
<li>You can define a profile for different configurations using the
<code>profiles</code> scope. These profiles can be selected when
launching a pipeline execution by using the <code>-profile</code>
command-line option</li>
<li>Nextflow configuration settings are evaluated in the order they are
read-in.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-01"><p>Content from <a href="01.html">Auxiliary Tools</a></p>
<hr>
<p>Last updated on 2025-06-28 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/01.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>When should I use a pre-built container?</li>
<li>How can I customise a container?</li>
<li>What is a remote codespace?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to reproduce code.</li>
<li>Understand the benefits of containers.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="docker-hub">Docker Hub<a class="anchor" aria-label="anchor" href="#docker-hub"></a>
</h2>
<hr class="half-width">
<p>By sharing a container, you create a portable and replicable research
environment that can be easily accessed and used by other researchers.
This process not only facilitates collaboration but also ensures that
your work is preserved in an environment where it can be run without
compatibility issues, i.e you can do your best to ‚Äòfuture-proof‚Äô your
research.</p>
<p>To share your code and software, you‚Äôll use Docker Hub. <a href="https://www.docker.com/get-started/" class="external-link">Docker hub</a> is a
cloud-based registry service that lets you share and distribute
container images.</p>
<p>There is a sea of containers out there, it is not necessarily safe to
use a docker container, as there is always risk of malware. The
following involves guidance on best practice:</p>
<ul>
<li>The container image is updated regularly, the latest version should
be available alongside previous versions.</li>
<li>There is a Dockerfile or other listing of what has been installed to
the container image.</li>
<li>The container image page has documentation on how to use the
container image.</li>
</ul>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p>If a container image is never updated, and does not have a lot of
metadata, it is probably worth skipping over. Even if such a container
image is secure, it is not reproducible and not a dependable way to run
research computations.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="docker-recipe-file">Docker Recipe File<a class="anchor" aria-label="anchor" href="#docker-recipe-file"></a>
</h3>
<p>Much like a cookbook, you can pull out recipes and alter to own
preference. This is how you normally get started building your own
image, you can start with a base repository.</p>
<div id="task-11.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-11.1" class="callout-inner">
<h3 class="callout-title">Task 11.1</h3>
<div class="callout-content">
<p>In this case we use a base image for R on a Linux machine, from
bioconductor. We layer requirements, i.e code libraries.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>To do this we evaluate the command <code>install.packages()</code>
using R. This is possible as we work within the docker container which
has already installed R. We install packages directly from CRAN, in this
case the recipe file could be improved on by requesting exact versions
for packages.</p>
<p>We also demonstrate installing RSiena version <code>1.4.19</code>
from source code. Note as we build the container, we realise this is a
self-contained enviroment and so need to manage file paths the same way
we would with a folder that takes up its own space on our directory. To
do this we copy the source code into the top level of our container and
then use option
<code>install.packages(...,repos = NULL, type= 'source')</code>. The
next steps involve pushing the local container onto docker hub, under
the name, <code>siena_r</code> and a version tag number. As this is an
iterative process, the version tag number we are working with here
follows the semi-colon <code>siena_r:0.8</code>. In some cases you may
require a specific version of a container; however, the most recent
version can also be requested with <code>siena_r:latest</code>.</p>
<pre class="docker"><code>
FROM bioconductor/bioconductor_docker:devel-R-4.4.1

RUN R -e "install.packages(c('Matrix', 'lattice', 'parallel', 'MASS', 'methods', 'xtable', 'network', 'vioplot', 'sna', 'codetools', 'dplyr', 'metafor', 'argparse', 'stringr', 'mixmeta'), repos = c(CRAN = 'https://cloud.r-project.org'))"

COPY rsiena_1.4.19.tar.gz .

RUN R -e "install.packages('rsiena_1.4.19.tar.gz', repos = NULL, type = 'source')"
</code></pre>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="git">Git<a class="anchor" aria-label="anchor" href="#git"></a>
</h4>
<div id="task-11.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-11.2" class="callout-inner">
<h3 class="callout-title">Task 11.2</h3>
<div class="callout-content">
<figure><img src="../fig/version-control.svg" alt="Arrows indicate users making changes and synchronizing their work with the repository." class="figure mx-auto d-block"><div class="figcaption">Arrows indicate users making changes and
synchronizing their work with the repository.</div>
</figure>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> ready-set-workflow <span class="at">--single-branch</span> https://github.com/omiridoue/sgsss-workflow.git</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="containers-in-the-workflow">Containers in the workflow<a class="anchor" aria-label="anchor" href="#containers-in-the-workflow"></a>
</h4>
<p>Within our workflow we can specify the container we want to use, as a
matter of fact we can specify a container for different processes - the
possibility is endless! Say for example you would like to write
interoperable code and use Python for one part of your analysis and R
for another part, this is possible by defining a different container for
each process. Another option is to build one container with all the
software (i.e R and Python) installed.</p>
<p>Say we work with one container, but would like to make sure the
pipeline is portable. In this case we work with profiles, which is
another layer for customisation.</p>
</div>
<div class="section level4">
<h4 id="alternative-platforms-for-compute-clusters">Alternative Platforms for compute clusters<a class="anchor" aria-label="anchor" href="#alternative-platforms-for-compute-clusters"></a>
</h4>
<p>Many container platforms are available, but Apptainer is designed for
ease-of-use on shared systems and in high performance computing (HPC)
environments. Nextflow can build an immutable image based off a Docker
recipe file.</p>
<p><strong>Building an Apptainer Image</strong></p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">singularity</span> pull docker://omiridoue-siena_r:0.8</span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="workflow-definition">Workflow Definition<a class="anchor" aria-label="anchor" href="#workflow-definition"></a>
</h4>
<p>Within our workflow, we can declare a process container, and ensure
we enable apptainer. Again we don‚Äôt want to hard code this decision as
we‚Äôd like to keep options as flexible as possible. This is why we build
a profile for each our compute environments, in this case for our local
machine / GitHub codespace we have access to Docker. However, for our
slurm profile, relevant to a computer cluster with Slurm workload
manager, we opt for apptainer (former singularity), as docker is not
available.</p>
<div id="task-11.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-11.3" class="callout-inner">
<h3 class="callout-title">Task 11.3</h3>
<div class="callout-content">
<p>We can declare a different config file for different compute
environments, or profiles. These profiles are stored under the conf
sub-folder.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">GROOVY<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode groovy" tabindex="0"><code class="sourceCode groovy"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">// nextflow.config</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>profiles <span class="op">{</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  local <span class="op">{</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    includeConfig <span class="st">'conf/local.config'</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    process<span class="op">.</span>container <span class="op">=</span> <span class="st">'omiridoue/siena_r:0.8'</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  slurm <span class="op">{</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    includeConfig <span class="st">'conf/slurm.config'</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    process<span class="op">.</span>executor <span class="op">=</span> <span class="st">'slurm'</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    process<span class="op">.</span>container <span class="op">=</span> <span class="st">'omiridoue/siena_r:0.8'</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The Docker Hub is an online repository of container images.</li>
<li>Find a container recipe file that works for your project and
customise this.</li>
<li>Nextflow can pull a docker container from Docker Hub and convert
this to an Apptainer image.</li>
<li>Docker is not permitted on most HPC environments, apptainer sif
files are used instead.</li>
<li>Containers are important to reproducible workflows and portability
of workflows across environments.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</section></section><section id="aio-11"><p>Content from <a href="11.html">Resuming a Workflow</a></p>
<hr>
<p>Last updated on 2025-07-05 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/11.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I restart a Nextflow workflow after an error?</li>
<li>How can I add new data to a workflow without starting from the
beginning?</li>
<li>Where can I find intermediate data and results?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Resume a Nextflow workflow using the <code>-resume</code>
option.</li>
<li>Restart a Nextflow workflow using new data.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A key feature of workflow management systems, like Nextflow, is
re-entrancy, which is the ability to restart a pipeline after an error
from the last successfully executed process. Re-entrancy enables time
consuming successfully completed steps, such as index creation, to be
skipped when adding more data to a pipeline. This in turn leads to
faster prototyping and development of workflows, and faster analyses of
additional data.</p>
<p>Nextflow achieves re-entrancy by automatically keeping track of all
the processes executed in your pipeline via caching and
checkpointing.</p>
<div id="task-12.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-12.1" class="callout-inner">
<h3 class="callout-title">Task 12.1</h3>
<div class="callout-content">
<p>To restart from the last successfully executed process we add the
command line option <code>-resume</code> to the Nextflow command.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>For example, the command below would resume the
<code>06_modules_optional.nf</code> script from the last successful
process.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">nextflow</span> run 02_hello_nextflow.nf <span class="at">-resume</span></span></code></pre>
</div>
<p>We can see in the output that the results from the processes have
been retrieved from the cache.</p>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="how-does-resume-work">How does resume work?<a class="anchor" aria-label="anchor" href="#how-does-resume-work"></a>
</h2>
<hr class="half-width">
<p>Nextflow stores all intermediate files and task results during the
execution of a workflow is <code>work</code> directory. It acts as a
scratch space where all the temporary data required for the workflow‚Äôs
execution is kept. Within the work directory, Nextflow creates
subdirectories named with unique hashes (e.g., work/ab/cd1234‚Ä¶). Each of
these subdirectories corresponds to a specific process or task in the
pipeline. The hashed directory names ensure that each task‚Äôs outputs are
isolated and uniquely identified.</p>
<p>The mechanism works by assigning a unique ID to each task. This
unique ID is used to create a separate execution directory, within the
<code>work</code> directory, where the tasks are executed and the
results stored. A task‚Äôs unique ID is generated as a 128-bit hash number
obtained from a composition of the task‚Äôs:</p>
<ul>
<li>Inputs values</li>
<li>Input files</li>
<li>Command line string</li>
<li>Container ID</li>
<li>Conda environment</li>
<li>Environment modules</li>
<li>Any executed scripts in the bin directory</li>
</ul>
<p>When we resume a workflow Nextflow uses this unique ID to check
if:</p>
<ol style="list-style-type: decimal">
<li>The working directory exists</li>
<li>It contains a valid command exit status</li>
<li>It contains the expected output files.</li>
</ol>
<p>If these conditions are satisfied, the task execution is skipped and
the previously computed outputs are applied. When a task requires
recomputation, ie. the conditions above are not fulfilled, the
downstream tasks are automatically invalidated.</p>
<p>Therefore, if you modify some parts of your script, or alter the
input data using <code>-resume</code>, will only execute the processes
that are actually changed.</p>
<p>The execution of the processes that are not changed will be skipped
and the cached result used instead.</p>
<p>This helps a lot when testing or modifying part of your pipeline
without having to re-run it from scratch.</p>
<p><strong>The Work directory</strong></p>
<p>By default the pipeline results are cached in the directory
<code>work</code> where the pipeline is launched.</p>
<div id="task-12.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-12.2" class="callout-inner">
<h3 class="callout-title">Task 12.2</h3>
<div class="callout-content">
<p>We can use the Bash <code>tree</code> command to list the contents of
the work directory. <strong>Note:</strong> By default tree does not
print hidden files (those beginning with a dot <code>.</code>). Use the
<code>-a</code> to view all files.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">tree</span> <span class="at">-a</span> work</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p><strong>Task execution directory</strong></p>
<p>Within the <code>work</code> directory there are multiple task
execution directories. There is one directory for each time a process is
executed. These task directories are identified by the process execution
hash. For example the task directory
<code>fa/cd3e49b63eadd6248aa357083763c1</code> would be location for the
process identified by the hash <code>fa/cd3e49</code> .</p>
<p>The task execution directory contains:</p>
<ul>
<li><p><code>.command.sh</code>: The command script. The
<code>.command.sh</code> file includes the specific instructions you‚Äôve
written to process your data or perform computations.</p></li>
<li><p><code>.command.run</code>: A Bash script generated by Nextflow to
manage the execution environment of the <code>.command.sh</code> script.
This script acts as a wrapper around .command.sh. It performs several
tasks like setting up the task‚Äôs environment variables, handling the
task‚Äôs pre and post execution (like moving inputs and outputs to correct
locations, logging start and end times, handling errors, and ensuring
resource limits are respected</p></li>
<li><p><code>.command.out</code>: The complete job standard
output.</p></li>
<li><p><code>.command.err</code>: The complete job standard
error.</p></li>
<li><p><code>.command.log</code>: The wrapper execution output.</p></li>
<li><p><code>.command.begin</code>: A file created as soon as the job is
launched.</p></li>
<li><p><code>.exitcode</code>: A file containing the task exit code.
This file is used to capture and store the exit status of the process
that was run by the .command.sh script.</p></li>
<li><p>Any task input files (symlinks)</p></li>
<li><p>Any task output files</p></li>
</ul>
</div>
</div>
</div>
</div>
<p><strong>Specifying another work directory</strong></p>
<p>Depending on your script, this work folder can take a lot of disk
space. You can specify another work directory using the command line
option <code>-w</code>. <strong>Note</strong> Using a different work
directory will mean that any jobs will need to re-run from the
beginning.</p>
<p><strong>Clean the work directory</strong></p>
<div id="task-12.3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-12.3" class="callout-inner">
<h3 class="callout-title">Task 12.3</h3>
<div class="callout-content">
<p>If you are sure you won‚Äôt resume your pipeline execution, clean this
folder periodically using the command <code>nextflow clean</code>.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">nextflow</span> clean [run_name<span class="kw">|</span><span class="ex">session_id]</span> <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Supply the option <code>-n</code> to print names of files to be
removed without deleting them, or <code>-f</code> to force the removal
of the files. If you only want to remove files from a run but retain
execution log entries and metadata, add the option <code>-k</code>.
Multiple runs can be cleaned with the options, <code>-before</code>,
<code>-after</code> or <code>-but</code> before the run name. For
example, the command above would remove all the temporary files and log
entries for runs before the run.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Nextflow automatically keeps track of all the processes executed in
your pipeline via checkpointing.</li>
<li>Nextflow caches intermediate data in task directories within the
work directory.</li>
<li>Nextflow caching and checkpointing allows re-entrancy into a
workflow after a pipeline error or using new data, skipping steps that
have been successfully executed.</li>
<li>Re-entrancy is enabled using the <code>-resume</code> option.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-12"><p>Content from <a href="12.html">Portability of Workflow</a></p>
<hr>
<p>Last updated on 2025-06-29 |

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/episodes/12.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I move my analysis to a computer cluster?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Discuss ways to implement own research directory.</li>
<li>Explore links to the wider network for computational
researchers.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Workflow managers support portability of analysis across compute
environments and scale your analysis. This is quite important given the
time required to set-up from scratch and work the ropes of using HPC. A
good number of HPCs rely on workload managers like Slurm, including the
resources I access as a PGR student, at the MVLS school, University of
Glasgow. Some the following may map on to the resources you can access
to support your research. Please contact your HPC administrator team to
request support with setting up.</p>
<figure><img src="../fig/image.png" alt="Archie West, Edinburgh Parallel Computing Centre (EPCC), Institutions University of Glasgow, University of Edinburgh, University of St.¬†Andrews, University of Strathclyde" class="figure mx-auto d-block"><div class="figcaption">Archie West, Edinburgh Parallel Computing Centre
(EPCC), Institutions University of Glasgow, University of Edinburgh,
University of St.¬†Andrews, University of Strathclyde</div>
</figure><p>Once you register an account with your HPC resource, the most
straightforward way to install Nextflow is by creating a stand-alone
‚Äòenvironment‚Äô using the software management tool, conda.</p>
<p>You may require support with this step, please get in touch with your
HPC support team. You will also require singularity / apptainer - to set
up a container to run your project. Check whether this is already
installed, if not please request further support from your HPC team.</p>
<div id="task-13.1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-13.1" class="callout-inner">
<h3 class="callout-title">Task 13.1</h3>
<div class="callout-content">
<p>Installing Nextflow is required to run the pipeline. Note this is a
different level of abstratction to the auxiliary tools you may are
likely to access within your pipeline, i.e docker or apptainer. The more
straightforward way to install the Nextflow software and dependencies is
to set up a conda environment. Conda or miniforge is commonly made
available on compute clusters, as it simplifies downloading
software.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Conda </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<pre><code>conda create --name nf-env bioconda::nextflow
</code></pre>
<p>Activate the conda environment.</p>
<pre><code>conda activate nf-env
</code></pre>
<p>Install graphviz if you would like to render reports and a timeline
for the workflow. May not work if you don‚Äôt have elevated permissions,
but likely to work on you local machine.</p>
<pre><code>sudo apt install graphviz
</code></pre>
<p>Hint: You will need to activate the environment each time you need to
use it. You will know you have entered the environment whenever you see
the name of the environment appear in parentheses (nf-env) along your
command line. The default, i.e no environment is (base).</p>
</div>
</div>
</div>
</div>
<p>We saw various different profiles are used to define nextflow
configuration profiles to determine how a workflow is actually run on
the target system.</p>
<p>If not otherwise specified, processes are run on the local computer.
The local runtime is very useful for pipeline development and testing
purposes, but for real world computational pipelines an HPC or cloud
platform is often required.</p>
<p>You may require support with this step, please get in touch with your
HPC support team. You will also require singularity / apptainer - to set
up a container to run your project. Check whether this is already
installed, if not please request further support from your HPC team.</p>
<p>We can seamlessly transfer analysis from your computer, a grid
platform, or the cloud, without modifying it, by simply defining the
target platform in the configuration file. This is where our workflow
management system shines through and ensures we can build portability
and interoperability into our analysis.</p>
<div id="task-13.2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="task-13.2" class="callout-inner">
<h3 class="callout-title">Task 13.2</h3>
<div class="callout-content">
<p>This is specific to SLURM, the workload manager, and involves a batch
job submission. Essentially, this command asks for resource for nextflow
to schedule a series of jobs and orchestrate the moving parts of our
analysis.</p>
<figure><img src="../fig/nf-executors.png" alt="Nextflow workflow managers supporting multiple compute environments including local computers, high performance computing clusters with Slurm, and cloud services such as AWS and Google Cloud." class="figure mx-auto d-block"><div class="figcaption">Nextflow workflow managers supporting multiple
compute environments including local computers, high performance
computing clusters with Slurm, and cloud services such as AWS and Google
Cloud.</div>
</figure>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Alas, we can tap into the seamless portability of Nextflow across set
ups (ex. local, slurm, azure). You can switch between these compute
environments by selecting an appropriate profile to run your pipeline.
The appropriate profile in my case was <code>slurm</code>, you can tuck
away this set-up information by creating a new profile in the
<code>conf/</code> subfolder (ex. <code>conf/slurm.config</code>). Then
the command I would use to schedule the launch of the pipeline say using
2 hours and 5 minutes would involve the following:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> ready-set-workflow <span class="at">--single-branch</span> https://github.com/omiridoue/sgsss-workflow.git</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">sbatch</span> <span class="at">-A</span> none <span class="at">-J</span> <span class="st">"demo"</span> <span class="at">--time</span><span class="op">=</span>02:05:00 <span class="at">--wrap</span> <span class="st">'nextflow run /mnt/scratch/users/&lt;username&gt;/sgsss-workflow/main.nf -profile slurm'</span></span></code></pre>
</div>
<p>Hint: replace the file path to your sgsss-workflow/main.nf file with
the appropriate directory on your computer cluster.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">sacct</span> <span class="at">--starttime</span> 2025-07-10 <span class="at">--format</span><span class="op">=</span>User,JobID,Jobname%50,partition,state,time,start,end,elapsed,MaxRss,MaxVMSize,nnodes,ncpus,nodelist</span></code></pre>
</div>
<p>An important detail to note is, the time we request to run our batch
job submission is not necessarily the time required to run the entire
pipeline. The reason for this is that <code>sbatch</code> schedules our
jobs to run via nextflow. This means you can max out time permitted to
run your batch submission, to ensure all jobs are submitted within this
time frame. For any jobs submitted within the timeframe but not
scheduled to complete, there is no problem you can prevent a possible
‚Äòtime-out‚Äô by specifying
<code>export NXF_DISABLE_JOBS_CANCELLATION=true</code> to add this to
your system variables.</p>
<figure><img src="../fig/sbatch-slurm.png" alt="Batch job submission on compute cluster using the workflow profile slurm." class="figure mx-auto d-block"><div class="figcaption">Batch job submission on compute cluster using
the workflow profile slurm.</div>
</figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Nextflow provides an abstraction between the pipeline‚Äôs functional
logic and the underlying execution system.</li>
<li>The nextflow configuration file can help define a target platform
where we intend to implement our workflow.</li>
<li>We can specify a profile for our target platform through the
<code>-profile</code> option.</li>
</ul>
</div>
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/omiridoue/sgsss_workflow/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/omiridoue/sgsss_workflow/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/omiridoue/sgsss_workflow/" class="external-link">Source</a></p>
				<p><a href="https://github.com/omiridoue/sgsss_workflow/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:e.omiridou.1@research.gla.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/omiridoue/varnish/tree/main" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://omiridoue.github.io/sgsss_workflow/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "workflow, reproducible, computation social science",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://omiridoue.github.io/sgsss_workflow/instructor/aio.html",
  "identifier": "https://omiridoue.github.io/sgsss_workflow/instructor/aio.html",
  "dateCreated": "2025-04-03",
  "dateModified": "2025-07-22",
  "datePublished": "2025-07-22"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

